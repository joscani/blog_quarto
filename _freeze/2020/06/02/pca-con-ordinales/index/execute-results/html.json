{
  "hash": "513abfa8cc7ae4e3de37f2d56ff0fdf0",
  "result": {
    "markdown": "---\ntitle: ¿PCA con ordinales? Primera entrega\ndate: '2020-06-02'\ncategories:\n  - estadística\n  - factorial\ndescription: ''\nexecute: \n  message: false\n  warning: false\n  echo: true\nformat: \n  html: \n    fig-height: 5\n    fig-dpi: 300\n    fig-width: 8.88\n    fig-align: center\n    code-fold: show\n    code-summary: \"Mostrar / ocultar código\"\nknitr:\n  opts_chunk:\n    out.width: 80%\n    fig.showtext: TRUE\n    collapse: true\n    comment: \"#>\" \n---\n\n\nSupongo que todos sabemos lo de las escalas de medida, ¿verdad? Nominal, ordinal, intervalo y de razón. \nY que todos sabemos lo que es un PCA y que sólo sirve para variables numéricas, ¿seguro?. Un PCA y otras técnicas relacionadas se basan en diagonalizar una matriz, ya sea mediante SVD, autovalores o a lo [Gifi](https://link.springer.com/chapter/10.1007/978-3-319-93177-7_8#:~:text=The%20Gifi%20system%20is%20a,first%20part%20of%20this%20chapter.) en dónde se utiliza Alternative Least Squares. \n\nLa materia prima de la que parte un PCA es una matriz de covarianzas o de correlaciones, pero, ¿qué pasa si nuestras variables no son numéricas sino ordinales? Pues entonces podemos utilizar lo que se conoce como correlaciones [policóricas](https://en.wikipedia.org/wiki/Polychoric_correlation), propuestas por Pearson en 1900,  aunque os aconsejo leer el artículo que viene en la [Encyclopedia Of Statistica Sciences](https://www.wiley.com/en-us/Encyclopedia+of+Statistical+Sciences%2C+16+Volume+Set%2C+2nd+Edition-p-9780471150442), ojo, 9686 páginas y 7680$ que cuestan todos los volúmenes.  \n\nBásicamente, las correlaciones policóricas suponen la existencia de variables latentes continuas asociadas a las variables ordinales observadas. La estimación de la correlación policórica entre dos variables se basa en encontrar la distribución normal bivariante subyacente y el coeficiente de correlación de pearson que mejor aproxima las frecuencias observadas en la tabla de contingencia entre las dos varibles ordinales.\nLa librería `polycor` de R incorpora la función `polychor` que implementa el cálculo. Se puede ver el código simplemente poniendo `polycor::polychor`, si tienes la librería instalada, por supuesto. \n\nPues una vez tenemos estas correlaciones podemos aplicar las técnicas de PCA o de Análisis factorial sobre nuestra matriz. Veamos un ejemplo, de un curso que di hace unos años en la Pablo de Olavide. \n\nUtilizamos el conjunto de datos Science:  Consumer Protection and Perceptions of Science and Technology section of the 1992 Euro-Barometer Survey (Karlheinz and Melich, 1992) based on a sample from Great Britain.\nSe pregunta por diferentes aspectos de la ciencia, y las categorías de respuesta son \"strongly disagree\",\"disagree\", \"agree\" y \"strongly agree\" .\n\n **Variables**\n\n* Comfort: _Science and technology are making our lives healthier, easier and more comfortable._\n\n* Environment: _Scientific and technological research cannot play an important role in protecting the environment and repairing it._\n\n* Work: _The application of science and new technology will make work more interesting._\n\n* Future: _Thanks to science and technology, there will be more opportunities for the future generations._\n\n* Technology: _New technology does not depend on basic scientific research._\n\n* Industry: _Scientific and technological research do not play an important role in industrial development._\n\n* Benefit: _The benefits of science are greater than any harmful effect it may_ have.\n\n\nTengo los datos guardados en un `rds` y subidos al github\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\ndatos <- readRDS(here::here(\"data/science.rds\"))\n\nhead(datos)\n#>          Comfort       Environment           Work         Future     Technology\n#> 1 strongly agree    strongly agree strongly agree          agree strongly agree\n#> 2          agree    strongly agree          agree          agree          agree\n#> 3          agree          disagree       disagree       disagree strongly agree\n#> 4          agree             agree       disagree       disagree strongly agree\n#> 5          agree strongly disagree strongly agree strongly agree       disagree\n#> 6 strongly agree             agree strongly agree          agree          agree\n#>         Industry           Benefit\n#> 1          agree          disagree\n#> 2          agree             agree\n#> 3 strongly agree             agree\n#> 4 strongly agree             agree\n#> 5          agree strongly disagree\n#> 6 strongly agree             agree\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(datos)\n#>               Comfort               Environment                 Work    \n#>  strongly disagree:  5   strongly disagree: 29   strongly disagree: 33  \n#>  disagree         : 32   disagree         : 90   disagree         : 98  \n#>  agree            :266   agree            :145   agree            :206  \n#>  strongly agree   : 89   strongly agree   :128   strongly agree   : 55  \n#>                Future                Technology               Industry  \n#>  strongly disagree: 14   strongly disagree: 18   strongly disagree: 10  \n#>  disagree         : 72   disagree         : 91   disagree         : 47  \n#>  agree            :210   agree            :157   agree            :173  \n#>  strongly agree   : 96   strongly agree   :126   strongly agree   :162  \n#>               Benefit   \n#>  strongly disagree: 21  \n#>  disagree         :100  \n#>  agree            :193  \n#>  strongly agree   : 78\n```\n:::\n\n\nNos aseguramos de que los niveles de los factores están codificados correctamente y en el orden que queremos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlevels(datos$Work)\n#> [1] \"strongly disagree\" \"disagree\"          \"agree\"            \n#> [4] \"strongly agree\"\n```\n:::\n\n\n\nPues ya podemos utilizar las correlaciones policóricas y el análisis factorial o un PCA. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\nlibrary(polycor)\n```\n:::\n\n\nUtilizamos la función `hetcor` que nos permite calcular correlaciones entre variables continuas, entre continuas con dicotómicas, continuas con ordinales y entre ordinales. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_poly <-  hetcor(datos)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor_poly\n#> \n#> Two-Step Estimates\n#> \n#> Correlations/Type of Correlation:\n#>             Comfort Environment       Work     Future Technology   Industry\n#> Comfort           1  Polychoric Polychoric Polychoric Polychoric Polychoric\n#> Environment 0.09934           1 Polychoric Polychoric Polychoric Polychoric\n#> Work         0.2012    -0.08277          1 Polychoric Polychoric Polychoric\n#> Future       0.3463    -0.02804     0.4786          1 Polychoric Polychoric\n#> Technology  0.08963      0.4638    -0.1039   -0.03596          1 Polychoric\n#> Industry     0.1857      0.4108  -0.007643     0.1027     0.4348          1\n#> Benefit       0.408    -0.03652     0.2086     0.3769   -0.01434      0.118\n#>                Benefit\n#> Comfort     Polychoric\n#> Environment Polychoric\n#> Work        Polychoric\n#> Future      Polychoric\n#> Technology  Polychoric\n#> Industry    Polychoric\n#> Benefit              1\n#> \n#> Standard Errors:\n#>             Comfort Environment    Work  Future Technology Industry\n#> Comfort                                                            \n#> Environment 0.06309                                                \n#> Work        0.06062      0.0594                                    \n#> Future      0.05651     0.06057 0.04566                            \n#> Technology  0.06331     0.04529  0.0591 0.06049                    \n#> Industry    0.06306     0.04979 0.06213 0.06176    0.04825         \n#> Benefit     0.05315     0.05985  0.0566 0.05062    0.05977  0.06078\n#> \n#> n = 392 \n#> \n#> P-values for Tests of Bivariate Normality:\n#>             Comfort Environment      Work    Future Technology Industry\n#> Comfort                                                                \n#> Environment  0.1763                                                    \n#> Work        0.00592     0.01337                                        \n#> Future       0.3163     0.00311    0.3021                              \n#> Technology  0.01695    0.001547   0.07819  0.009519                    \n#> Industry     0.4694   1.891e-05 0.0001493 0.0005283  4.817e-07         \n#> Benefit     0.08673    0.005932   0.01871  0.009679    0.06082 0.007907\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncorrplot::corrplot(cor_poly$correlations)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=80%}\n:::\n:::\n\n\nY sin más hacemos el análisis factorial. Veamos qué número de factores elegimos \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\nVSS(cor_poly$correlations)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=80%}\n:::\n\n```\n#> \n#> Very Simple Structure\n#> Call: vss(x = x, n = n, rotate = rotate, diagonal = diagonal, fm = fm, \n#>     n.obs = n.obs, plot = plot, title = title, use = use, cor = cor)\n#> VSS complexity 1 achieves a maximimum of 0.7  with  2  factors\n#> VSS complexity 2 achieves a maximimum of 0.78  with  7  factors\n#> \n#> The Velicer MAP achieves a minimum of 0.07  with  2  factors \n#> BIC achieves a minimum of  -19.96  with  3  factors\n#> Sample Size adjusted BIC achieves a minimum of  -10.44  with  3  factors\n#> \n#> Statistics by number of factors \n#>   vss1 vss2   map dof   chisq     prob sqresid  fit RMSEA BIC SABIC complex\n#> 1 0.39 0.00 0.083  14 6.6e+02 2.4e-132     6.0 0.39 0.215 566   610     1.0\n#> 2 0.70 0.73 0.074   8 7.7e+01  2.1e-13     2.6 0.73 0.093  22    47     1.1\n#> 3 0.67 0.78 0.131   3 7.6e-01  8.6e-01     2.0 0.80 0.000 -20   -10     1.3\n#> 4 0.67 0.78 0.244  -1 2.5e-07       NA     2.0 0.80    NA  NA    NA     1.2\n#> 5 0.67 0.78 0.429  -4 9.0e-08       NA     1.9 0.80    NA  NA    NA     1.2\n#> 6 0.67 0.78 1.000  -6 8.8e-13       NA     1.9 0.80    NA  NA    NA     1.2\n#> 7 0.67 0.78    NA  -7 8.8e-13       NA     1.9 0.80    NA  NA    NA     1.2\n#>    eChisq    SRMR  eCRMS eBIC\n#> 1 1.3e+03 1.8e-01 0.2174 1227\n#> 2 6.8e+01 4.0e-02 0.0651   13\n#> 3 4.8e-01 3.4e-03 0.0089  -20\n#> 4 1.6e-07 1.9e-06     NA   NA\n#> 5 6.2e-08 1.2e-06     NA   NA\n#> 6 3.5e-13 2.9e-09     NA   NA\n#> 7 3.5e-13 2.9e-09     NA   NA\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres_factorial <-  fa(cor_poly$correlations, nfactors = 3, n.obs = nrow(datos))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndiagram(res_factorial)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=80%}\n:::\n:::\n\nY listo ya tenemos el análsis factorial hecho. Ahora habría que interpretar y demás, ver las cargas factoriales y las comunalidades (cómo  de bien está representada la variable en la estructura factorial)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres_factorial$loadings\n#> \n#> Loadings:\n#>             MR2    MR1    MR3   \n#> Comfort      0.168  0.222  0.357\n#> Environment  0.666              \n#> Work                0.617       \n#> Future              0.813       \n#> Technology   0.695              \n#> Industry     0.632              \n#> Benefit                    0.861\n#> \n#>                  MR2   MR1   MR3\n#> SS loadings    1.362 1.096 0.885\n#> Proportion Var 0.195 0.157 0.126\n#> Cumulative Var 0.195 0.351 0.478\nres_factorial$communalities\n#>     Comfort Environment        Work      Future  Technology    Industry \n#>   0.2940500   0.4429437   0.3519061   0.6846375   0.4854217   0.4208926 \n#>     Benefit \n#>   0.7309609\n```\n:::\n\n\n\nAunque el análisis lo hemos hecho utilizando las correlaciones policóricas, para obtener las puntuaciones para cada fila  hay que convertir los datos a numéricos. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nscience.num <- data.frame(sapply(datos, as.numeric))\ntable(datos$Comfort, science.num$Comfort)\n#>                    \n#>                       1   2   3   4\n#>   strongly disagree   5   0   0   0\n#>   disagree            0  32   0   0\n#>   agree               0   0 266   0\n#>   strongly agree      0   0   0  89\n```\n:::\n\n\n## Science data: Puntuaciones factoriales\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npuntuaciones <- factor.scores(science.num, res_factorial)\npuntuaciones$scores\n#>                 MR2          MR1          MR3\n#>   [1,]  0.983783784  0.586931403 -0.704801916\n#>   [2,]  0.316308160  0.075403203  0.072119271\n#>   [3,]  0.511214907 -1.267647217  0.111088544\n#>   [4,]  0.971164636 -1.283190166  0.069652282\n#>   [5,] -1.601261361  1.428869944 -1.845504751\n#>   [6,]  0.483437248  0.817348345  0.546986739\n#>   [7,]  0.511546440 -0.225286108  1.304894202\n#>   [8,] -0.035027006 -0.161537530  1.334985660\n#>   [9,]  0.980349283  1.002260263 -0.808566327\n#>  [10,]  0.016011850  0.319878827  0.455157733\n#>  [11,] -0.666247071  1.124247892  0.248753651\n#>  [12,] -0.059594604 -1.574845059  0.129568131\n#>  [13,] -0.057017852  0.042740522  0.124900336\n#>  [14,] -1.656341385  0.019112260 -0.995177681\n#>  [15,]  0.948905669 -0.480305368 -1.046938254\n#>  [16,]  1.392694657  0.089972097  0.133589749\n#>  [17,] -0.549010849 -1.868036524 -1.172346199\n#>  [18,] -0.690215015  0.154694729  0.143646992\n#>  [19,] -0.517567236 -0.385470894 -0.933974272\n#>  [20,] -1.220028066  0.076377257  0.052085055\n#>  [21,] -0.897804321 -2.013344274 -0.408168528\n#>  [22,]  0.510946786 -0.669040472  0.204583332\n#>  [23,] -0.143641569  0.090946151  0.113555533\n#>  [24,] -1.555827177 -0.838028790 -0.602960737\n#>  [25,] -1.039904617  0.049224102 -0.892270941\n#>  [26,] -0.057617506 -0.401013842 -0.975410534\n#>  [27,]  0.378695812 -0.343748845  0.071852202\n#>  [28,]  0.016011850  0.319878827  0.455157733\n#>  [29,]  1.541106372 -0.821139944 -0.955643386\n#>  [30,]  0.378695812 -0.343748845  0.071852202\n#>  [31,]  0.012845469  0.136600942  0.257898535\n#>  [32,] -0.603922832 -0.935872010 -1.038813862\n#>  [33,]  0.211250129  0.019189516  1.687932664\n#>  [34,]  0.822484801  0.226528620  1.252380205\n#>  [35,]  1.431445899 -0.256372004  1.222021678\n#>  [36,] -0.841499957 -0.068187324  0.537763188\n#>  [37,] -0.143641569  0.090946151  0.113555533\n#>  [38,] -1.150164745  0.170237677  0.185083253\n#>  [39,] -0.046375802  0.739030874  0.455424802\n#>  [40,] -1.293389301 -1.243122157 -1.471977999\n#>  [41,] -0.143641569  0.090946151  0.113555533\n#>  [42,] -0.286802713  0.318554172 -0.256205275\n#>  [43,]  0.015080662 -1.166236647 -1.838958794\n#>  [44,] -1.174132688 -0.799315486  0.079976594\n#>  [45,]  0.315976627 -0.966957907 -1.121686386\n#>  [46,]  1.599952430  1.215649990 -0.508400389\n#>  [47,] -0.665978950  0.525641147  0.155258864\n#>  [48,]  0.288242649 -2.563543320 -2.524363114\n#>  [49,] -0.296087439  0.973632688 -0.001286612\n#>  [50,] -1.679977795  0.091920206  0.093521317\n#>  [51,] -0.119673625  1.060499315  0.218662193\n#>  [52,]  1.392694657  0.089972097  0.133589749\n#>  [53,] -0.119673625  1.060499315  0.218662193\n#>  [54,]  1.393026191  1.132333206  1.327395406\n#>  [55,]  1.393026191  1.132333206  1.327395406\n#>  [56,] -0.603591298  0.106489100  0.154991795\n#>  [57,] -0.057617506 -0.401013842 -0.975410534\n#>  [58,] -1.402003864 -0.990638475 -2.693408126\n#>  [59,] -1.543960787  0.393660827  1.523822514\n#>  [60,]  1.306339062 -0.460429019  0.028750158\n#>  [61,]  1.440299012  0.986717314 -0.850002589\n#>  [62,]  1.629519025 -1.416144540  1.458250149\n#>  [63,]  0.475961579  0.304335878  0.413721471\n#>  [64,]  1.469534074 -2.687438325 -0.077157708\n#>  [65,] -0.603591298  0.106489100  0.154991795\n#>  [66,] -1.112076570 -2.260828643 -1.114096132\n#>  [67,] -0.168209167 -1.322361377 -1.091861997\n#>  [68,] -1.033028602  0.118482204 -1.859316543\n#>  [69,] -1.237119995 -0.823917804 -1.020067207\n#>  [70,] -1.555202491 -0.746383889  0.092987179\n#>  [71,] -0.493930825 -0.458278840 -2.022673269\n#>  [72,]  1.431114366 -1.298733114  0.028216020\n#>  [73,]  1.490291957  1.780417929  1.669264675\n#>  [74,]  0.051328590  0.388863586  1.439825251\n#>  [75,]  0.971496170 -0.240829056  1.263457940\n#>  [76,]  0.622995850 -1.336853014  1.529777870\n#>  [77,] -0.666578605  0.081886782 -0.945052006\n#>  [78,] -0.822465989  0.479986356  0.010915862\n#>  [79,] -0.081253917 -0.328205896  0.113288464\n#>  [80,]  1.513928368  1.707609983  0.580565678\n#>  [81,]  0.005369800 -0.376411525  0.124633267\n#>  [82,] -1.586146530  1.155333789  0.331626175\n#>  [83,] -0.373743025  1.471643304  1.823397851\n#>  [84,]  1.552348076  0.318904772  0.475191949\n#>  [85,]  1.662340082  0.796497942 -0.508667458\n#>  [86,]  1.541106372 -0.821139944 -0.955643386\n#>  [87,] -0.943368166 -0.095290420  0.757745590\n#>  [88,] -1.483881767 -2.241683546  1.434728452\n#>  [89,] -0.555986944  1.003234317 -0.828600543\n#>  [90,] -1.111745036 -1.218467534  0.079709525\n#>  [91,] -2.015152221 -0.730840941  0.134423441\n#>  [92,]  0.463010898 -2.608146799 -0.005629988\n#>  [93,]  1.304282004  0.684976693 -2.280303786\n#>  [94,]  0.465319529 -0.391954473  0.083197005\n#>  [95,] -3.438023559  1.325474742  0.925957627\n#>  [96,]  0.909108518  0.178322991  1.263725009\n#>  [97,]  0.621206913 -0.790054047 -0.872770862\n#>  [98,] -0.081585450 -1.370567006 -1.080517193\n#>  [99,] -0.839226384  0.622052405  0.132569257\n#> [100,]  0.932413395 -0.936846064 -1.018779646\n#> [101,]  1.502686664  0.567565267 -0.850269658\n#> [102,]  1.068162282 -0.036498698  0.505016339\n#> [103,]  0.300147419  0.661223616  1.294083536\n#> [104,]  0.476561233  0.748090243  1.514032341\n#> [105,] -0.167277980  0.163754097  1.202254530\n#> [106,] -0.468173945 -0.035524643  0.484982123\n#> [107,]  0.741647896 -1.605983261 -0.404948116\n#> [108,]  0.967354922  1.771358561  0.610657136\n#> [109,]  1.392694657  0.089972097  0.133589749\n#> [110,] -1.975979755 -1.481114201 -2.872187738\n#> [111,]  0.364180636  0.373541675 -1.004967854\n#> [112,] -0.151448772 -1.464427425 -1.213515392\n#> [113,] -1.047380287 -0.463788365 -1.025536208\n#> [114,] -2.139927525  0.107463154  0.134957579\n#> [115,]  1.416331068  0.017164151 -0.955109248\n#> [116,] -1.656341385  0.019112260 -0.995177681\n#> [117,]  0.409807892  0.096455676 -0.883581528\n#> [118,] -3.118716722  1.783340093  1.609162027\n#> [119,] -1.519992844  1.363213991  1.628929174\n#> [120,] -0.049810304  1.154359734  0.351660391\n#> [121,]  0.943718511  1.844166507  1.699356134\n#> [122,] -0.555986944  1.003234317 -0.828600543\n#> [123,] -1.150164745  0.170237677  0.185083253\n#> [124,] -1.126528334  0.097429731 -0.903615744\n#> [125,]  0.347751774  1.557968833  0.310491198\n#> [126,]  0.763638742 -1.810261314  0.805137207\n#> [127,] -0.270725504 -1.286942080  0.025262678\n#> [128,]  1.392363124 -0.952389013 -1.060215908\n#> [129,] -0.628158897 -1.306818428 -1.050425735\n#> [130,]  1.415999535 -1.025196959 -2.148914906\n#> [131,]  0.932744928  0.105515045  0.175026011\n#> [132,] -0.603591298  0.106489100  0.154991795\n#> [133,] -0.081253917 -0.328205896  0.113288464\n#> [134,]  1.455413843  0.713181159  1.327128337\n#> [135,]  1.022866558  1.282948411  1.577435670\n#> [136,]  1.439967479 -0.055643795 -2.043808246\n#> [137,]  1.106913523 -0.382842799  1.593448267\n#> [138,]  0.275579821 -0.752083912  0.088666007\n#> [139,]  1.393026191  1.132333206  1.327395406\n#> [140,] -0.081253917 -0.328205896  0.113288464\n#> [141,]  0.078399502 -0.099273221  0.454890664\n#> [142,] -1.006940188  1.583597510  1.842144506\n#> [143,] -0.541203646 -0.312662948  0.154724726\n#> [144,] -0.033381441 -0.030067424 -0.963798661\n#> [145,] -0.143641569  0.090946151  0.113555533\n#> [146,]  1.493502018 -1.717885161  0.027948951\n#> [147,] -1.815994803 -0.209820416 -1.336779881\n#> [148,] -0.143973102 -0.951414958 -1.080250124\n#> [149,] -1.108836751  1.441479157  1.268847388\n#> [150,] -1.286181752 -0.131502945 -1.245217944\n#> [151,]  0.910154428 -0.133961267 -2.135370183\n#> [152,]  1.552679609  1.361265882  1.668997606\n#> [153,]  1.454750776 -1.371541060 -1.060482977\n#> [154,] -0.603591298  0.106489100  0.154991795\n#> [155,] -0.517567236 -0.385470894 -0.933974272\n#> [156,] -1.196391655  0.003569311 -1.036613943\n#> [157,]  0.784065093  1.615233831  1.357753934\n#> [158,]  0.316308160  0.075403203  0.072119271\n#> [159,]  0.337109724  0.861678482 -0.020033267\n#> [160,] -0.081253917 -0.328205896  0.113288464\n#> [161,]  0.608212552 -0.020955749  0.546452601\n#> [162,] -0.081585450 -1.370567006 -1.080517193\n#> [163,]  0.838913663 -0.957898538 -0.063078847\n#> [164,] -0.019197798 -1.789719053 -1.080784262\n#> [165,] -0.082962894 -2.100643857  1.124772341\n#> [166,] -0.081253917 -0.328205896  0.113288464\n#> [167,] -0.189868480 -0.075722214 -1.108141663\n#> [168,]  0.378695812 -0.343748845  0.071852202\n#> [169,] -0.327262931 -1.107539688 -0.333153327\n#> [170,] -0.022407859  1.708584038  0.560531462\n#> [171,] -0.035090418 -1.802505385  0.047685216\n#> [172,]  1.552348076  0.318904772  0.475191949\n#> [173,]  1.392363124 -0.952389013 -1.060215908\n#> [174,]  1.006106163  1.425014459  1.699089065\n#> [175,] -0.024384956  0.534752821  1.665510126\n#> [176,]  1.576316020  1.288457936  0.580298609\n#> [177,]  1.552348076  0.318904772  0.475191949\n#> [178,] -0.627559242 -0.863064064  0.049885135\n#> [179,] -0.143641569  0.090946151  0.113555533\n#> [180,] -0.738150903 -1.784411598 -0.066566328\n#> [181,]  0.507405192  1.786901509  0.652093398\n#> [182,] -1.077135043  0.447375981  0.515340650\n#> [183,] -0.935331223 -1.131600907  0.299658330\n#> [184,] -1.150164745  0.170237677  0.185083253\n#> [185,] -0.143973102 -0.951414958 -1.080250124\n#> [186,] -0.136765554  0.160204254 -0.853490069\n#> [187,] -0.547321992  0.525693453  0.606902587\n#> [188,] -0.690215015  0.154694729  0.143646992\n#> [189,]  1.493833551 -0.675524052  1.221754609\n#> [190,]  1.599952430  1.215649990 -0.508400389\n#> [191,] -1.239954842  0.035165421 -0.023520748\n#> [192,]  1.615067261  0.942113834  1.668730537\n#> [193,] -0.610798847 -1.005130112 -0.071768260\n#> [194,] -1.558744085  1.709558092  0.540497246\n#> [195,] -0.134688376 -1.606493474 -1.335168787\n#> [196,]  1.416662601  1.059525260  0.238696409\n#> [197,] -0.771051920 -1.677817152 -1.513681330\n#> [198,] -0.787480782 -0.493389994 -0.198222278\n#> [199,]  0.956712872  1.075068209  0.280132671\n#> [200,] -0.127212707 -1.093481007 -1.201903519\n#> [201,] -1.529277569  2.018292506  1.883847837\n#> [202,]  0.569792844  1.367749461  0.651826329\n#> [203,] -0.603259765  1.148850209  1.348797452\n#> [204,] -0.073778247  0.184806571  0.246553732\n#> [205,] -0.604190953 -0.337265265 -0.945319075\n#> [206,]  0.943718511  1.844166507  1.699356134\n#> [207,]  0.260796524  0.563813353 -0.894659262\n#> [208,] -0.081585450 -1.370567006 -1.080517193\n#> [209,]  0.362535071  0.242071569  1.293816467\n#> [210,] -0.264875279 -1.526691735 -0.333420396\n#> [211,] -1.519992844  1.363213991  1.628929174\n#> [212,]  0.492721974  0.162269830  0.292068076\n#> [213,] -0.492141889 -1.005077807  0.379875463\n#> [214,]  1.614735728 -0.100247275  0.474924880\n#> [215,] -0.143641569  0.090946151  0.113555533\n#> [216,] -1.174400809 -0.200708742  0.173471381\n#> [217,]  0.796128266 -0.639979941 -2.355586056\n#> [218,] -0.143641569  0.090946151  0.113555533\n#> [219,] -0.112197956  1.573511782  0.351927460\n#> [220,]  1.392694657  0.089972097  0.133589749\n#> [221,]  0.355059402 -0.270940898  1.160551199\n#> [222,] -0.616585659  0.875587398  1.574215258\n#> [223,]  0.909108518  0.178322991  1.263725009\n#> [224,] -0.690546549 -0.887666381 -1.050158666\n#> [225,] -0.697422564 -0.956924483 -0.083113063\n#> [226,]  1.552348076  0.318904772  0.475191949\n#> [227,] -1.610714128 -0.257973739 -0.873791354\n#> [228,]  0.608812207  0.422798615  1.646763471\n#> [229,] -1.008629045 -0.810132466  0.062895720\n#> [230,] -1.109767939 -0.044636318 -1.025269139\n#> [231,] -0.627227709  0.179297046  1.243690792\n#> [232,] -0.589407655 -1.653162530  0.038006194\n#> [233,] -0.381550228 -0.083730272  0.496326926\n#> [234,] -0.119673625  1.060499315  0.218662193\n#> [235,]  0.464987996 -1.434315583 -1.110608652\n#> [236,]  0.386503015  1.211624732  1.398923127\n#> [237,] -0.530561597  0.383627404  0.485249192\n#> [238,]  0.956381339  0.032707099 -0.913672986\n#> [239,]  0.386171482  0.169263623  0.205117470\n#> [240,] -1.150164745  0.170237677  0.185083253\n#> [241,] -1.610114474  0.185780625  0.226519515\n#> [242,]  1.552348076  0.318904772  0.475191949\n#> [243,] -0.389918704 -0.089780895 -0.239391471\n#> [244,] -0.534059510 -0.842011590 -0.905815664\n#> [245,]  0.933076461  1.147876155  1.368831668\n#> [246,]  1.354274949  1.478677308  0.238963478\n#> [247,]  1.479050253  0.640373213  0.238429340\n#> [248,] -0.213504890 -0.002914268 -0.019442666\n#> [249,] -0.326931398 -0.065178578  0.860652330\n#> [250,]  0.085875171  0.413739246  0.588155932\n#> [251,] -1.071016697 -0.390980419  0.063162789\n#> [252,] -0.074377902 -0.258947794 -0.853757138\n#> [253,]  0.355327523 -0.869547643  1.067056412\n#> [254,]  0.496431609  0.048250048 -0.872236724\n#> [255,] -0.443937880  0.335421775  0.496593995\n#> [256,] -2.092323170  1.004208371 -0.848634759\n#> [257,]  0.886518017 -0.061153320 -1.046671185\n#> [258,] -0.057617506 -0.401013842 -0.975410534\n#> [259,] -0.990511326  0.399170352  0.526685454\n#> [260,] -1.656341385  0.019112260 -0.995177681\n#> [261,]  0.995132580 -0.313637002  0.174758942\n#> [262,]  1.552348076  0.318904772  0.475191949\n#> [263,]  1.537564778  1.634802037 -0.508133320\n#> [264,] -0.635134991  1.564452413 -0.706680079\n#> [265,] -2.867813702  1.188918218 -0.192832829\n#> [266,]  0.316308160  0.075403203  0.072119271\n#> [267,]  0.760097149  0.645680668  1.252647274\n#> [268,]  0.054763091 -0.026465275  1.543589662\n#> [269,]  0.210318942 -1.466925958 -0.606183863\n#> [270,]  1.295097358 -1.600473736 -1.402085177\n#> [271,] -1.087777093 -0.248914370  0.184816185\n#> [272,]  1.493833551 -0.675524052  1.221754609\n#> [273,] -1.634019005  0.857195316  1.408713300\n#> [274,] -0.649486676  0.982181844  0.127100256\n#> [275,] -1.512517174  1.876226458  1.762194442\n#> [276,]  0.846121211  0.153720674  0.163681208\n#> [277,]  0.464719875 -0.835708838 -1.017113864\n#> [278,]  0.862881607  0.011654626  0.042027812\n#> [279,] -0.530561597  0.383627404  0.485249192\n#> [280,] -0.745395119  1.685465988  0.370674115\n#> [281,]  1.046502969  1.210140465  0.488736672\n#> [282,] -1.087777093 -0.248914370  0.184816185\n#> [283,]  0.402931877  0.027197574  0.083464074\n#> [284,]  0.402931877  0.027197574  0.083464074\n#> [285,] -1.688930988  1.789359831  1.542245637\n#> [286,]  1.393026191  1.132333206  1.327395406\n#> [287,] -1.247762044 -1.520208156 -1.350591673\n#> [288,] -0.701188598 -1.583956733 -1.380683131\n#> [289,] -2.059090620  1.939975035  1.792285900\n#> [290,] -0.541203646 -0.312662948  0.154724726\n#> [291,] -0.603591298  0.106489100  0.154991795\n#> [292,]  0.472795199  0.121057994  0.216462273\n#> [293,] -0.850199967 -1.116599056 -1.391760866\n#> [294,]  0.869757622  0.080912728 -0.925017790\n#> [295,]  0.039648260  0.247070881 -0.633541264\n#> [296,]  0.378963933 -0.942355589 -0.021642585\n#> [297,]  0.005369800 -0.376411525  0.124633267\n#> [298,] -0.105221861 -1.297759060  0.008181804\n#> [299,] -1.656341385  0.019112260 -0.995177681\n#> [300,]  1.537564778  1.634802037 -0.508133320\n#> [301,] -0.049810304  1.154359734  0.351660391\n#> [302,]  0.448559134 -0.249888425  0.204850401\n#> [303,] -0.059594604 -1.574845059  0.129568131\n#> [304,] -1.220028066  0.076377257  0.052085055\n#> [305,] -1.126528334  0.097429731 -0.903615744\n#> [306,] -1.220028066  0.076377257  0.052085055\n#> [307,] -1.133672470  0.626778373  0.156924646\n#> [308,]  1.493833551 -0.675524052  1.221754609\n#> [309,]  0.410139426  1.138816786  0.310224129\n#> [310,] -1.019646308  1.132797048  0.377140519\n#> [311,]  0.862550073 -1.030706484 -1.151777845\n#> [312,]  1.354274949  1.478677308  0.238963478\n#> [313,]  1.478718720 -0.401987897 -0.955376317\n#> [314,] -1.133404349  0.028171629  0.063429858\n#> [315,]  0.346820586  0.071853359 -1.983625329\n#> [316,] -1.236188807  0.662197671  1.274049320\n#> [317,] -0.666247071  1.124247892  0.248753651\n#> [318,]  0.101474638  1.377241787 -0.042455805\n#> [319,] -1.033296723  0.717088949 -1.765821756\n#> [320,] -0.143641569  0.090946151  0.113555533\n#> [321,] -0.120005158  0.018138205 -0.975143465\n#> [322,] -0.081585450 -1.370567006 -1.080517193\n#> [323,] -0.096037214  0.987691369 -0.870036805\n#> [324,] -0.143641569  0.090946151  0.113555533\n#> [325,]  1.552348076  0.318904772  0.475191949\n#> [326,] -0.666578605  0.081886782 -0.945052006\n#> [327,] -2.037143067 -0.526562888 -1.075661883\n#> [328,] -0.081253917 -0.328205896  0.113288464\n#> [329,] -0.229665632  0.582906145  1.202521599\n#> [330,] -1.676479882  1.317559200  1.484586172\n#> [331,]  0.316639694  1.117764312  1.265924928\n#> [332,]  1.368726714 -0.879581067  0.028483089\n#> [333,]  0.869757622  0.080912728 -0.925017790\n#> [334,]  1.393026191  1.132333206  1.327395406\n#> [335,] -0.711874328  1.401333891  0.127367325\n#> [336,]  0.389937516  0.796295872  1.502687538\n#> [337,]  0.423660002 -2.705557063 -2.194372786\n#> [338,]  1.392363124 -0.952389013 -1.060215908\n#> [339,] -0.057617506 -0.401013842 -0.975410534\n#> [340,]  1.392694657  0.089972097  0.133589749\n#> [341,] -0.849868434 -0.074237947 -0.197955209\n#> [342,] -0.080985796 -0.926812641  0.019793677\n#> [343,] -1.507330016 -0.448245417 -0.984099946\n#> [344,]  1.416662601  1.059525260  0.238696409\n#> [345,]  0.555109626 -0.256882217  0.291801007\n#> [346,] -1.133072816  1.070532738  1.257235515\n#> [347,] -0.199421327  1.177963046 -0.759728213\n#> [348,]  1.092398347  0.334447721  0.516628211\n#> [349,] -0.081253917 -0.328205896  0.113288464\n#> [350,]  0.981806686 -0.586899814  0.400176748\n#> [351,]  0.884540919 -1.234984537  0.058307479\n#> [352,] -0.143641569  0.090946151  0.113555533\n#> [353,] -0.714182959 -0.814858435  0.038540332\n#> [354,]  1.057520232 -0.732789050  0.174491873\n#> [355,] -0.279658577 -0.210794470 -1.316745665\n#> [356,]  0.869757622  0.080912728 -0.925017790\n#> [357,]  0.598323260 -0.078814150 -2.685309315\n#> [358,]  1.590767784 -1.069800439  0.369818221\n#> [359,] -1.805309073 -3.195111040 -2.844830337\n#> [360,] -0.143909690  0.689552896  0.207050320\n#> [361,] -0.565171590 -1.282216111  0.049618066\n#> [362,] -0.184038375  0.305820146  1.323907926\n#> [363,]  0.023219398  1.431498039  0.681917788\n#> [364,] -0.081253917 -0.328205896  0.113288464\n#> [365,]  1.005774630  0.382653350  0.505283408\n#> [366,]  0.039648260  0.247070881 -0.633541264\n#> [367,]  0.386171482  0.169263623  0.205117470\n#> [368,]  0.402931877  0.027197574  0.083464074\n#> [369,]  1.392694657  0.089972097  0.133589749\n#> [370,] -1.512517174  1.876226458  1.762194442\n#> [371,] -0.230265286  0.139151780  0.102210730\n#> [372,]  1.369058247  0.162780043  1.222288747\n#> [373,] -0.119405504  0.461892570  0.125167405\n#> [374,]  0.594028909  1.738695880  0.663438202\n#> [375,]  1.490291957  1.780417929  1.669264675\n#> [376,] -0.143641569  0.090946151  0.113555533\n#> [377,]  1.197500058 -3.290919568 -2.937760103\n#> [378,]  0.110442769  1.827046775  1.793573461\n#> [379,]  0.005101679  0.222195220  0.218128055\n#> [380,]  0.032772245  0.177812778  0.333504338\n#> [381,]  0.029006211 -0.449219471 -0.964065730\n#> [382,]  1.490291957  1.780417929  1.669264675\n#> [383,]  1.018437457 -1.428806058 -2.107745713\n#> [384,] -0.677220654 -0.614403569 -1.275576472\n#> [385,] -0.689883482  1.197055838  1.337452649\n#> [386,] -1.512517174  1.876226458  1.762194442\n#> [387,] -0.689883482  1.197055838  1.337452649\n#> [388,]  1.541106372 -0.821139944 -0.955643386\n#> [389,] -1.117243608 -0.557648785 -1.158534407\n#> [390,]  0.297527375 -3.218621835 -2.779281777\n#> [391,] -1.710821754 -0.946891060  0.955460259\n#> [392,] -0.096368748 -0.054669741 -2.063842462\n```\n:::\n\n\nY ya con esas tres dimensiones ya podemos hacer lo que queramos. \n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}