<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="jlcr">
<meta name="dcterms.date" content="2021-05-21">

<title>Muestrear no es pecado - Big data para pobres II. Â¿AUC?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../../../site_libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<link href="../../../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../../../site_libs/datatables-binding-0.26/datatables.js"></script>
<script src="../../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../../../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../../../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../../../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="../../../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Muestrear no es pecado</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/joscani"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/joscani"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@joscani"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../../blog.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://rweekly.org/">
 <span class="dropdown-text">R Weekly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.r-bloggers.com/">
 <span class="dropdown-text">R Bloggers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.datanalytics.com/">
 <span class="dropdown-text">Datanalytics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../../archive.html">
 <span class="menu-text">Archivo</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#glmer" id="toc-glmer" class="nav-link active" data-scroll-target="#glmer">glmer</a>
  <ul class="collapse">
  <li><a href="#predicciÃ³n-del-glmer" id="toc-predicciÃ³n-del-glmer" class="nav-link" data-scroll-target="#predicciÃ³n-del-glmer">PredicciÃ³n del glmer</a></li>
  <li><a href="#auc" id="toc-auc" class="nav-link" data-scroll-target="#auc">AUC</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Big data para pobres II. Â¿AUC?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">estadÃ­stica</div>
    <div class="quarto-category">2021</div>
    <div class="quarto-category">big data</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>jlcr </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 21, 2021</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Bueno, pues voy a ampliar el ejemplo del <a href="https://muestrear-no-es-pecado.netlify.app/2021/05/14/cosas-viejunas-o-big-data-para-pobres/">Ãºltimo dÃ­a</a>, como es viernes, estoy cansado y me irÃ© a tomar una birra pronto, intentarÃ© ser breve.</p>
<p>Levantamos una sesiÃ³n de spark y leemos los mismos datos del otro dÃ­a. Ya de paso voy a probar el operador pipe nativo en R base <code>|&gt;</code>. Si tienes la nueva versiÃ³n de R instalada y la versiÃ³n de Rstudio preview, en global options puedes poner para que al hacer Ctrl + Shift +M aparezca el nuevo operador o el antiguo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sparklyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">spark_connect</span>(<span class="at">master =</span> <span class="st">"local"</span>, <span class="at">spark_home =</span> <span class="st">"~/spark/spark-3.0.0-bin-hadoop2.7"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> sc <span class="sc">|&gt;</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spark_read_parquet</span>(<span class="at">path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/bd_pobres.parquet"</span> ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># en el nuevo operador es necesario el parÃ©ntesis. </span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tmp <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source: spark&lt;?&gt; [?? x 4]</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   valor_cliente  edad segmento tipo </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             3    79 No_way   B    </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             3    79 No_way   B    </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             3    79 No_way   B    </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             3    79 No_way   B    </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             3    79 No_way   B    </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6             3    79 No_way   B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Discretizamos la edad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_spark <span class="ot">&lt;-</span>  tmp <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">edad_cat =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>           edad <span class="sc">&lt;=</span> <span class="dv">20</span> <span class="sc">~</span> <span class="st">"&lt;21"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>           edad <span class="sc">&lt;=</span> <span class="dv">40</span> <span class="sc">~</span> <span class="st">"21- 40"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>           edad <span class="sc">&lt;=</span> <span class="dv">50</span> <span class="sc">~</span> <span class="st">"41-50"</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>           edad <span class="sc">&lt;=</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"40-60"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>           edad <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">~</span> <span class="st">"&gt;60"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_spark)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Source: spark&lt;?&gt; [?? x 5]</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   valor_cliente  edad segmento tipo  edad_cat</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1             3    79 No_way   B     &gt;60     </span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2             3    79 No_way   B     &gt;60     </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3             3    79 No_way   B     &gt;60     </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4             3    79 No_way   B     &gt;60     </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5             3    79 No_way   B     &gt;60     </span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6             3    79 No_way   B     &gt;60</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y ahora vamos a crear conjunto de train y de test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>particiones <span class="ot">&lt;-</span>  df_spark <span class="sc">|&gt;</span> <span class="fu">sdf_random_split</span>(<span class="at">training =</span> <span class="fl">0.6</span>, <span class="at">test =</span> <span class="fl">0.4</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> particiones<span class="sc">$</span>training</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> particiones<span class="sc">$</span>test </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y ahora procedemos a agregar los datos y traerlos a local. Y seguro que alguno se pregunta Â¿por quÃ© no haces el modelo en spark?. PodrÃ­a hacerlo, ya he contado en este blog como hacer modelos usando sparkling water por ejemplo, pero podrÃ­a querer ajustar un tipo de modelo que no estÃ© en distribuido, no sÃ©, un modelo mixto con <code>glmer</code> o con <code>stan</code> . De hecho es eso lo que voy a hacer, un <code>glmer</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>train_local <span class="ot">&lt;-</span> train <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(segmento,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>           tipo,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>           valor_cliente,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>           edad_cat) <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()  <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ponemos las variables categÃ³ricas a tipo factor</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as_factor))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(train_local)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-eff9439adf7d6e86cdc7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-eff9439adf7d6e86cdc7">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671"],["Rec","Best","Neut","Rec","Neut","Best","Neut","Neut","Neut","Rec","Rec","Best","No_way","No_way","Best","No_way","Rec","No_way","Best","Rec","No_way","Rec","Best","Best","Neut","Best","Neut","Best","Best","Best","No_way","Neut","No_way","Best","Best","No_way","Best","Rec","No_way","No_way","No_way","Rec","Best","No_way","Rec","No_way","Best","Neut","Rec","Rec","Best","No_way","Best","Rec","No_way","Neut","Best","Neut","Neut","Rec","Neut","Neut","Neut","No_way","Rec","Best","Best","Best","Best","Neut","Neut","No_way","Best","Neut","Rec","Best","Neut","No_way","Best","Neut","No_way","Rec","Neut","Best","Neut","Best","No_way","Rec","No_way","Neut","Rec","Rec","No_way","Best","Neut","Best","Neut","Best","Neut","Best","Best","Neut","Neut","Rec","No_way","Rec","Best","Best","No_way","Best","Rec","Rec","Neut","No_way","No_way","Best","Neut","Rec","Rec","Best","No_way","Rec","Neut","No_way","Neut","Rec","Neut","Best","Neut","Best","Neut","Best","Rec","Best","No_way","Rec","Neut","No_way","Rec","Neut","Rec","Neut","Best","No_way","Rec","Best","Best","No_way","Neut","Neut","No_way","Best","Best","Neut","No_way","Neut","Neut","Best","Rec","Neut","No_way","Rec","Best","Rec","Best","Rec","No_way","Neut","No_way","Best","No_way","Rec","Best","Rec","Neut","Rec","Rec","Best","Best","No_way","No_way","Rec","Rec","Best","Best","Neut","No_way","Neut","No_way","Rec","Neut","Rec","Rec","Rec","Best","No_way","Best","Best","Rec","Rec","No_way","Neut","No_way","No_way","Neut","No_way","Rec","Neut","No_way","Rec","No_way","No_way","No_way","Neut","Rec","No_way","Best","Best","Rec","No_way","Neut","Neut","Rec","Rec","Neut","Rec","Neut","Best","Neut","Neut","Best","No_way","No_way","No_way","Rec","Rec","Best","No_way","Best","Rec","Rec","No_way","Best","Neut","Neut","Best","Neut","Rec","No_way","No_way","Neut","Neut","Rec","Neut","Neut","Rec","Rec","No_way","Best","Rec","Best","Rec","No_way","Rec","No_way","Best","Rec","No_way","No_way","Best","No_way","Rec","Rec","Best","Rec","Best","Best","Neut","No_way","No_way","Neut","No_way","Best","Neut","Rec","Best","Neut","No_way","No_way","No_way","Best","Best","No_way","Rec","No_way","No_way","Rec","No_way","Best","No_way","No_way","Best","Neut","No_way","Rec","No_way","Best","Rec","Rec","Rec","Neut","Neut","Neut","Rec","Neut","Rec","No_way","No_way","Best","No_way","Best","Best","No_way","No_way","Best","No_way","Rec","Best","Best","Neut","Best","Neut","Neut","Rec","Neut","No_way","Best","Neut","Best","Neut","Neut","Rec","Rec","No_way","Best","Neut","No_way","Best","Neut","Rec","Rec","Neut","Rec","Rec","Rec","No_way","Best","Neut","Rec","Best","Neut","Rec","No_way","Neut","No_way","Neut","No_way","No_way","Rec","No_way","Rec","Rec","No_way","Neut","Best","No_way","Best","No_way","Rec","Neut","Rec","Neut","No_way","Best","No_way","No_way","Best","Best","Neut","Neut","Neut","No_way","Neut","No_way","No_way","No_way","Rec","Rec","No_way","No_way","No_way","Best","Best","Best","Neut","Neut","No_way","Rec","Best","Neut","No_way","Best","No_way","Neut","No_way","Neut","Neut","No_way","Rec","No_way","Rec","Rec","Rec","Best","Rec","No_way","Rec","Rec","Best","Neut","Best","No_way","Neut","No_way","Neut","Best","No_way","Best","Best","No_way","No_way","Rec","Neut","Rec","Neut","No_way","Best","No_way","Rec","Neut","Neut","Best","Neut","Neut","No_way","Neut","No_way","No_way","Best","Neut","Rec","Rec","Neut","Rec","Rec","Neut","Best","Best","Best","Neut","Rec","Best","Neut","Rec","Rec","Best","Best","Neut","Best","Neut","Neut","Best","No_way","Neut","Best","Neut","Neut","Best","Neut","Neut","Rec","Neut","Best","No_way","Best","Neut","No_way","Best","No_way","No_way","No_way","Neut","Best","Best","Neut","Rec","Rec","Rec","Best","Best","Neut","No_way","Rec","No_way","Best","Best","Neut","No_way","No_way","No_way","No_way","Rec","No_way","No_way","No_way","No_way","Neut","Neut","Rec","Best","Best","Rec","Neut","Neut","Best","Rec","No_way","Rec","Neut","Best","Best","Neut","Rec","No_way","Rec","Neut","Neut","Rec","Neut","No_way","Best","Rec","Neut","Neut","Neut","No_way","No_way","Rec","Rec","Neut","Neut","Best","Rec","No_way","Best","Neut","Best","Rec","Neut","Neut","Neut","Best","Rec","Neut","Neut","Rec","Best","Neut","Rec","Neut","Neut","No_way","Neut","Neut","No_way","Best","Neut","Neut","No_way","Rec","No_way","Neut","Rec","Best","No_way","Best","Best","Neut","Best","No_way","No_way","Neut","Best","No_way","Best","Best","No_way","Best","Neut","No_way","Best","Rec","Best","No_way","Best","No_way","No_way","Rec","Rec","No_way","No_way","Best","Neut","No_way","No_way","No_way","No_way","Best","Best","Best","No_way","No_way","Rec","Neut","Neut","Rec","Best","Best","Rec","No_way","Best","No_way","Rec","Neut","Best","Neut","No_way","Best","No_way","Best","Best","No_way","Best","Rec","No_way","No_way","Best","Best","Neut","No_way","Best","Best","No_way","Neut","No_way","Rec","Neut","Neut","Best","Neut","Rec"],["C","B","SM","B","SM","SM","SF","B","SF","SM","SM","SF","C","SM","SM","C","C","SM","B","SF","B","SF","SF","C","C","SF","C","C","B","SM","B","SM","SM","B","C","SF","SF","C","SM","SF","C","C","B","SM","C","SM","C","C","C","C","SM","SM","SM","SF","SM","SF","B","C","B","C","SM","SM","SF","SF","B","C","SM","C","SM","SM","C","C","SM","B","C","C","B","SM","C","SF","SF","SF","SF","SM","SM","SF","C","B","C","C","SF","SM","C","SM","C","SM","C","SM","SM","SF","SF","SM","SM","C","B","B","SF","C","SM","B","C","SM","SF","B","C","C","SF","C","SF","SF","C","C","C","SF","SM","SF","SM","SF","SF","SM","SM","SM","C","SM","SM","B","SF","SM","SM","B","SM","SF","C","SF","SF","C","SF","SM","SM","SM","SM","C","B","SF","C","SF","C","C","B","C","C","B","B","SF","B","SF","SF","C","B","SM","C","C","SF","C","C","C","B","SF","C","C","SF","C","SF","C","B","SM","B","SF","SM","SF","SF","SM","B","SF","C","SM","C","B","SF","B","SM","SM","C","C","C","C","SF","B","SF","C","SM","SF","C","B","B","B","C","SF","C","SM","SF","SF","SF","B","B","B","SM","SF","B","SM","B","SM","B","C","SF","SM","B","SF","B","C","SM","C","B","B","SM","SM","SM","SF","C","SM","B","C","C","SM","C","B","C","B","C","SF","C","B","SM","B","SF","SM","B","SF","SM","B","B","C","C","SM","SM","SF","SM","C","SF","SM","SM","SM","SF","B","SM","B","SF","SM","B","SM","C","C","SF","C","SF","C","SF","B","C","SF","SF","C","B","SF","C","B","SF","C","B","B","SF","B","SF","SF","C","C","B","SF","SM","SF","SF","SM","B","C","B","SF","SM","B","SF","SM","SM","SF","SM","C","SM","SF","C","B","B","B","C","SF","C","SF","SM","C","C","C","SM","SM","B","SF","B","C","C","SM","C","SF","B","SF","B","SF","C","SF","B","C","SF","SM","B","SF","B","C","SF","SM","SM","B","SF","SM","C","SM","B","SF","SF","SF","B","C","C","SF","SF","C","SF","SF","C","C","B","SM","C","SF","B","SF","SF","B","SM","SM","B","B","SF","B","SF","C","SM","B","C","C","SM","B","SM","B","B","B","SM","B","C","SM","C","SM","B","SF","SF","SF","SM","B","SM","B","B","SM","SF","B","SF","C","SF","B","C","SF","C","B","C","SF","SF","B","B","SM","SM","B","SM","B","C","SF","SM","C","B","SM","B","SM","SF","SM","C","SF","C","C","B","B","SF","B","SF","C","C","C","B","B","C","B","B","SM","C","C","SF","SM","C","SF","C","SF","SM","SM","C","SF","B","B","SF","SM","SM","B","SF","SM","C","B","SF","B","B","SF","C","B","B","SF","B","SF","SM","B","C","SF","SM","B","B","B","C","C","B","C","SM","SF","SM","SM","SM","C","B","SM","B","C","C","B","C","B","SM","C","SM","C","SM","SM","B","B","B","SF","SF","C","C","B","SM","SF","SF","C","SM","SF","SF","B","C","SM","SM","C","B","SM","C","C","B","B","SF","SF","SF","SF","SM","SM","SF","B","B","C","SM","SM","B","SM","C","C","SM","B","SF","SF","C","SF","B","C","C","SM","C","SF","SF","B","B","C","SM","SF","B","C","C","SF","C","B","B","SF","B","B","SM","C","C","C","SF","B","C","SF","SM","B","SF","SM","B","SM","SF","B","C","C","SF","SM","SM","SF","SM","SM","B","SM","B","SF","C","SF","SF","SF","SM","C","B","SM","SF","SM","SF","B","B","C","SF","B","SF","B","C","C","B","SF","C","B","C"],[0,0,0,0,0,0,1,1,2,2,3,2,2,2,2,2,2,3,4,4,4,4,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,9,9,0,0,0,0,1,1,1,1,1,1,1,3,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,0,0,0,0,1,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,7,7,7,7,8,8,8,8,9,0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,8,8,8,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,9,0,0,0,0,0,1,1,1,2,3,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,8,8,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,2,2,3,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,0,0,0,0,0,0,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,0,0,0,0,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,8,8,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,9],["21- 40","41-50","41-50","41-50","40-60","&gt;60","41-50","&gt;60","&lt;21","21- 40","41-50","&lt;21","&lt;21","21- 40","40-60","40-60","&gt;60","41-50","41-50","41-50","40-60","&gt;60","21- 40","40-60","&gt;60","&gt;60","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","40-60","&gt;60","21- 40","40-60","&gt;60","&gt;60","21- 40","21- 40","21- 40","41-50","41-50","41-50","&lt;21","21- 40","21- 40","41-50","41-50","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","&gt;60","&lt;21","&lt;21","41-50","40-60","40-60","&gt;60","&lt;21","41-50","41-50","41-50","&gt;60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","40-60","&gt;60","&gt;60","21- 40","21- 40","40-60","&gt;60","21- 40","21- 40","40-60","&gt;60","21- 40","21- 40","41-50","41-50","40-60","40-60","&gt;60","&lt;21","&lt;21","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","40-60","40-60","&lt;21","&lt;21","&gt;60","&lt;21","&lt;21","&lt;21","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&gt;60","21- 40","41-50","&gt;60","&lt;21","21- 40","41-50","40-60","21- 40","21- 40","21- 40","41-50","40-60","21- 40","21- 40","21- 40","41-50","40-60","&gt;60","21- 40","21- 40","41-50","41-50","40-60","&gt;60","40-60","21- 40","21- 40","41-50","40-60","40-60","&gt;60","21- 40","41-50","40-60","&lt;21","21- 40","21- 40","41-50","&gt;60","21- 40","41-50","41-50","40-60","40-60","&lt;21","&lt;21","&lt;21","21- 40","21- 40","40-60","40-60","41-50","41-50","40-60","40-60","&gt;60","&lt;21","21- 40","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","21- 40","41-50","40-60","40-60","&lt;21","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","&lt;21","21- 40","21- 40","41-50","40-60","40-60","40-60","&gt;60","&lt;21","41-50","41-50","41-50","40-60","21- 40","41-50","41-50","40-60","40-60","&gt;60","21- 40","21- 40","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","&gt;60","41-50","41-50","40-60","40-60","&gt;60","&gt;60","21- 40","21- 40","40-60","&gt;60","&gt;60","&gt;60","21- 40","21- 40","41-50","&lt;21","40-60","21- 40","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","40-60","40-60","40-60","&gt;60","&lt;21","&lt;21","41-50","40-60","40-60","&gt;60","&lt;21","41-50","40-60","&gt;60","&gt;60","&lt;21","40-60","40-60","40-60","40-60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","40-60","&gt;60","&gt;60","21- 40","40-60","40-60","&gt;60","&gt;60","21- 40","21- 40","21- 40","41-50","41-50","41-50","40-60","40-60","40-60","40-60","&gt;60","&lt;21","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","21- 40","41-50","41-50","41-50","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","41-50","40-60","&gt;60","&gt;60","&lt;21","&lt;21","&lt;21","21- 40","21- 40","21- 40","21- 40","41-50","&gt;60","&gt;60","&lt;21","21- 40","41-50","40-60","&gt;60","41-50","40-60","21- 40","21- 40","41-50","41-50","41-50","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","41-50","40-60","&gt;60","21- 40","41-50","40-60","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","41-50","41-50","41-50","40-60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","21- 40","41-50","40-60","&gt;60","&lt;21","21- 40","21- 40","41-50","41-50","41-50","40-60","40-60","21- 40","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","41-50","41-50","41-50","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","&lt;21","41-50","40-60","&gt;60","&lt;21","&lt;21","21- 40","41-50","40-60","40-60","40-60","&gt;60","&gt;60","&gt;60","&gt;60","&lt;21","41-50","&lt;21","&lt;21","41-50","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","41-50","&lt;21","21- 40","40-60","40-60","&lt;21","&lt;21","21- 40","40-60","&gt;60","21- 40","41-50","41-50","41-50","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","40-60","40-60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","21- 40","41-50","41-50","41-50","41-50","41-50","40-60","&gt;60","&gt;60","41-50","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","40-60","&gt;60","&gt;60","41-50","41-50","40-60","&gt;60","&gt;60","41-50","&lt;21","21- 40","41-50","&gt;60","&lt;21","21- 40","21- 40","40-60","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","&lt;21","&lt;21","21- 40","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","41-50","41-50","40-60","&gt;60","&gt;60","41-50","41-50","41-50","40-60","40-60","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","41-50","40-60","&gt;60","&lt;21","&lt;21","41-50","41-50","40-60","41-50","40-60","41-50","40-60","40-60","40-60","&lt;21","&lt;21","&lt;21","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","&lt;21","&lt;21","40-60","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","21- 40","21- 40","41-50","40-60","40-60","40-60","21- 40","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&lt;21","21- 40","21- 40","21- 40","41-50","40-60","&lt;21","&lt;21","41-50","40-60","40-60","&gt;60","&gt;60","21- 40","41-50","41-50","41-50","41-50","40-60","40-60","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","40-60"],[183,29,159,10,97,45,28,57,3,6,18,8,33,26356,1721,1428,1760,22292,139,350,579,370,117,3679,12787,51,44,3327,41,249,102,353,1,17,481,46,11,1142,79,33,50,125,3,1,1,534,253,559,256,5,756,4071,477,48,18563,52,5,31,285,1846,8414,6682,1801,134228,81,13,25,4463,2155,7494,14811,14,1142,426,19710,2901,630,4759,14,2,278,114,116,152,733,84,1255,36,2384,1721,7,2,211,23,330,19,465,7,44,3,1,2,74,113,6,3,581,409,5270,2,8,3,2,4,14,4895,354,12809,1320,496,26339,12510,32,9,5048,433,4141,122,181,443,2003,3,8046,443,1633,85,87,1233,15,145,10,43,3,55,7,409,17,54,38,31,1,144,8,3,115,2,200,635,26,1046,362,14,37,195,179,412,3836,2458,818,1489,8100,14249,482,18,25397,14859,221,152,4018,5085,278,14618,102,18,1,2,80,133,810,42,19,1,4,4,256,1,91,5,4,2,50,13,50,1,449,103,2,29,34,167,45,32,409,76,17,86,415,194,486,138,155,174,269,39,1816,10,14243,746,712,26,198,4550,450,12683,316,21,133,3,66,13860,18,6476,47,143,913,175,773,41,146,90,28,2532,838,108,1147,4,608,22,111,6,70,1,38,2,1,105,1,161,384,3,167,423,504,70,12,647,5327,3799,2438,24920,6479,50200,14,861,15,161,219,20896,19776,22,10,5985,550,15987,1133,6,111,232,2294,346,2,3403,133,184,12058,171,1,439,5,9,17,28,11,9,1,90,6,16,8,47,8,49,59,102,87,2154,1,37,293,780,298,21,611,415,677,25,2093,234,63,285,2294,177,18,2094,3596,21256,11561,2913,5851,11,1,287,178,16496,9,1207,5006,139,72,46,218,125,8,3,1,12218,195,554,47,179,40,8264,2,126,54,15,10,67,173,171,6,5,33,12,14,78,64,10,9,16,37,1530,720,471,406,24249,1414,2170,1081,2070,2037,479,1497,6,1,546,693,314,184,31524,5161,84,21887,34,5,243,1811,149,98,172,16,87,5,312,4714,744,32,43,32,71,39,19,142,15,20,15,28,4,13,69,27,1,377,3,219,13,1,1,1,17,26,17,27,117,5250,47,282,1164,258,623,13,1,3,2,13,92,1840,411,1146,43,535,259,277,367,3,5715,3692,23971,1,3,17400,40,498,906,4322,18896,93,119,9675,1,2,22,39,128,1,6,7,6,27,1,1,18,17,106,294,1,30,95,107,443,3441,485,61,6095,325,3033,9958,1543,12559,8469,26206,375,4,345,7942,11913,350,19339,21,3,566,12,1586,22886,51,11,84,9427,19071,26,1884,108,13,2,2,2334,56,2,11,7,7,2,4,1,1,12,495,1,2,967,1084,167,34,446,23,12446,2966,1812,10,83,19329,2726,291,2442,418,1032,5,286,38,3142,189,2318,187,25265,1543,276,197,1338,6640,11707,6,1,33,61,2718,35,1,7,565,138,215,12,4,18,7,121,388,15,3,10,8,99,658,110,21,2093,6,1,1,2066,1759,1177,191,20661,2240,18,74,382,1093,5735,762,23709,1728,657,15077,10354,273,1776,25,603,730,5253,229,3,84,162,3005,74,293,4,1,1959,22,13,172,571,22,13,23,195,13,9,42,9,53,130,8,4,51,2,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>segmento<\/th>\n      <th>tipo<\/th>\n      <th>valor_cliente<\/th>\n      <th>edad_cat<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Tenemos 671 filas con la info de 1.456693^{6} observaciones</p>
<p>Agregamos y bajamos el test</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test_local <span class="ot">&lt;-</span> test <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(segmento,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           tipo,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           valor_cliente,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>           edad_cat) <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()  <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>() <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ponemos las variables categÃ³ricas a tipo factor</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as_factor))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(test_local)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9f71ab7d3e7a5e515d52" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9f71ab7d3e7a5e515d52">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654"],["Rec","Best","Neut","Rec","Neut","Best","Neut","Neut","Best","Neut","Rec","No_way","No_way","Best","No_way","Rec","No_way","Rec","Best","Rec","No_way","Rec","Best","Best","Best","Neut","Neut","Best","Best","Best","No_way","Neut","Best","Best","No_way","Rec","Best","No_way","No_way","No_way","Rec","No_way","Best","Neut","Rec","Rec","Best","No_way","Best","Rec","Rec","No_way","Neut","Best","Neut","Neut","Rec","Neut","Neut","Neut","No_way","Rec","Best","Best","Best","Best","Neut","Neut","No_way","Best","Neut","Rec","Best","Neut","No_way","Best","No_way","Rec","Neut","Best","Neut","No_way","Best","Rec","No_way","Neut","Rec","Rec","No_way","Neut","Best","Best","Neut","Best","Neut","Best","Neut","No_way","Neut","Rec","No_way","Rec","Best","Best","No_way","Rec","Neut","No_way","No_way","Best","Rec","Neut","Rec","Best","No_way","Rec","Neut","No_way","Neut","Rec","Neut","Best","Neut","Best","Neut","Best","Rec","Best","No_way","Rec","Neut","No_way","Rec","Neut","Rec","Neut","Best","No_way","Rec","Best","Rec","Best","Neut","No_way","Neut","Best","Best","Neut","No_way","Neut","Neut","Best","Rec","Neut","No_way","Rec","Best","Rec","Rec","Best","Rec","No_way","Neut","No_way","Best","No_way","Rec","Best","Rec","Neut","Rec","Rec","Best","Best","No_way","No_way","Rec","Rec","Best","Neut","Neut","No_way","No_way","Rec","Neut","Neut","Rec","Rec","Rec","Best","No_way","Best","Rec","Best","Rec","No_way","Neut","No_way","No_way","Neut","No_way","Rec","Neut","No_way","Rec","No_way","No_way","No_way","Neut","Rec","No_way","Best","Best","Rec","Neut","Rec","Rec","No_way","Neut","Rec","Rec","Neut","Neut","Best","Neut","Neut","Best","No_way","No_way","No_way","Rec","Best","No_way","Best","Rec","Rec","No_way","Best","Neut","Neut","Best","Neut","Rec","Neut","No_way","No_way","Neut","Rec","Neut","Neut","Rec","Rec","No_way","Best","Rec","Best","Rec","No_way","Rec","No_way","Neut","No_way","Best","Rec","No_way","No_way","Best","No_way","Rec","Rec","Best","Rec","Rec","Best","Best","Neut","No_way","No_way","Neut","No_way","Best","Neut","Best","Neut","No_way","No_way","No_way","Best","Best","No_way","Rec","No_way","No_way","No_way","Rec","No_way","Best","No_way","No_way","Best","Neut","No_way","Rec","No_way","Rec","Rec","Rec","Neut","Neut","Neut","Rec","Neut","Rec","No_way","Best","No_way","No_way","Best","Best","No_way","No_way","Best","Best","No_way","Best","Best","Neut","Best","Neut","Neut","Rec","Neut","Rec","Rec","No_way","Best","Neut","Best","Neut","Neut","Rec","No_way","Best","Neut","No_way","Best","Neut","Rec","Neut","Rec","Rec","Rec","No_way","Best","Neut","Rec","Best","Neut","Rec","Neut","No_way","Neut","No_way","No_way","Rec","No_way","Rec","Rec","Neut","Best","No_way","Best","No_way","Rec","Neut","Rec","Best","No_way","No_way","No_way","Best","Neut","Best","Neut","Neut","No_way","Neut","No_way","No_way","No_way","Rec","Rec","No_way","No_way","No_way","Best","Best","Neut","Best","Neut","No_way","Rec","Best","Neut","No_way","Best","No_way","Neut","No_way","Neut","Neut","No_way","Rec","No_way","Rec","Rec","Rec","Best","Rec","No_way","Rec","Rec","Best","Neut","Best","No_way","Neut","No_way","Neut","No_way","Best","Best","No_way","No_way","Rec","Neut","Rec","Neut","No_way","Best","No_way","Rec","Neut","Neut","Best","Neut","Neut","No_way","Neut","No_way","No_way","Best","Neut","Rec","Neut","Rec","Neut","Best","Best","Best","Neut","Rec","Rec","Best","Neut","Rec","Rec","Best","Best","Neut","Neut","Neut","Best","No_way","Neut","Best","Neut","Neut","Best","Neut","Neut","Best","No_way","Neut","No_way","Best","No_way","Neut","No_way","Neut","Best","Best","Neut","Rec","Rec","Rec","Rec","Best","Best","Neut","No_way","Rec","No_way","Best","Best","Neut","No_way","No_way","No_way","No_way","Rec","No_way","No_way","No_way","No_way","Neut","Neut","Best","Best","Rec","Neut","Neut","Best","Rec","No_way","Rec","Neut","Best","Best","Neut","Rec","No_way","Neut","Neut","Rec","Neut","No_way","Best","Rec","Neut","Neut","Neut","Neut","No_way","No_way","Rec","Neut","Neut","Best","Rec","No_way","Best","Neut","Best","Rec","Neut","Neut","Neut","Best","Rec","Neut","Neut","Rec","Best","Neut","Rec","Neut","Neut","No_way","Neut","Neut","No_way","Best","Neut","Neut","No_way","Rec","Neut","No_way","Rec","Best","No_way","Best","Neut","Best","No_way","No_way","Neut","Best","No_way","Best","Best","No_way","Best","Best","Neut","No_way","Rec","Best","No_way","Best","No_way","No_way","No_way","No_way","Best","Neut","No_way","No_way","No_way","No_way","Best","Best","Best","No_way","No_way","Rec","Neut","Neut","Rec","Best","Best","Rec","No_way","Best","No_way","Rec","Neut","Best","Neut","No_way","Best","No_way","Best","Best","No_way","Best","Rec","No_way","No_way","Best","Best","Best","Neut","No_way","Best","No_way","No_way","Neut","Rec","Neut","Neut","Best","Neut"],["C","B","SM","B","SM","SM","SF","B","SF","SF","SM","C","SM","SM","C","C","SM","SM","B","SF","B","SF","SF","C","SF","C","C","C","B","SM","B","SM","B","C","SF","C","SF","SM","SF","C","C","SM","C","C","C","C","SM","SM","SM","SF","SM","SM","SF","B","C","B","C","SM","SM","SF","SF","B","C","SM","C","SM","SM","C","C","SM","B","C","C","B","SM","C","SF","SF","SF","SM","SM","C","SF","B","C","C","SF","SM","C","C","SM","SM","C","SM","SM","SF","SM","B","SM","C","B","B","SF","C","SM","C","SF","B","C","C","C","SF","SF","SF","C","C","C","SF","SM","SF","SM","SF","SF","SM","SM","SM","C","SM","SM","B","SF","SM","SM","B","SM","SF","C","SF","SF","C","C","SF","SM","SM","SM","B","C","SF","C","SF","C","C","B","C","C","B","B","SF","SF","B","SF","SF","C","B","SM","C","C","SF","C","C","C","B","SF","C","C","SF","C","SF","C","SM","SF","B","SM","SF","SM","SF","SM","B","SF","C","SM","C","B","B","SF","SM","SM","C","C","C","C","SF","B","SF","C","SM","SF","C","B","B","B","C","SF","C","SF","B","SM","SM","SF","SF","B","B","SM","SF","B","SM","B","SM","B","C","SF","B","SF","B","C","SM","C","B","B","SM","SM","SM","SF","B","SM","C","C","C","SM","C","C","B","B","C","SF","C","B","SM","B","C","SM","SF","SM","B","SF","SM","B","B","C","C","SM","SM","SM","SF","SM","C","SF","SM","SM","SM","SF","B","B","SF","SM","B","SM","C","C","SF","C","SF","C","B","SF","B","C","SF","SF","C","B","SF","C","B","C","B","B","SF","B","SF","SF","C","C","B","SM","SF","SF","SF","SM","B","C","B","B","SF","B","SF","SM","SM","SF","SM","C","SM","SF","SM","SF","C","B","B","B","C","C","SF","SM","C","C","C","SM","B","SF","B","C","C","SM","C","SF","B","SF","B","SF","SF","C","C","SF","SM","B","SF","B","C","SM","SM","B","SF","SM","C","SM","B","SF","SF","B","C","C","SF","SF","C","SF","SF","C","C","B","SM","C","SF","B","SF","SF","B","SM","B","SM","B","SF","B","SF","C","SM","B","C","C","SM","B","SM","B","B","B","SM","B","C","SM","C","SM","B","SF","SF","SF","SM","B","SM","B","B","SF","SM","SF","C","SF","B","C","SF","C","B","C","SF","SF","B","B","SM","SM","B","SM","B","C","SF","SM","C","B","B","SM","SM","C","SF","C","C","SF","B","B","SF","B","SF","C","C","C","B","C","B","B","SM","C","C","SF","SM","C","SF","SM","SM","SF","B","B","SF","C","SM","B","SF","SM","C","B","SF","SM","B","B","SF","C","B","B","SF","B","SF","SM","B","C","SF","SM","B","B","B","C","C","B","C","SF","SM","SM","SM","C","B","SM","B","C","C","B","C","B","SM","C","C","SM","SM","B","B","B","SF","SF","SM","SM","C","B","SM","SF","C","SM","SF","SF","B","C","SM","SM","C","B","SM","C","C","B","B","SF","SF","SF","SF","SM","SM","SF","B","B","C","SM","SM","B","SM","C","C","B","SM","SF","SF","C","SF","C","C","SM","C","SF","SF","B","B","C","SM","C","SF","B","C","SF","C","B","B","SF","B","C","C","C","SF","B","C","SF","SM","B","SF","SM","B","SM","SF","B","C","C","SF","SM","SM","SF","SM","SM","B","SM","B","SF","C","SF","SF","SF","SM","C","B","SM","SF","SM","SF","B","SF","B","C","B","SF","C","B","C","B","SF","C","B"],[0,0,0,0,0,0,1,1,2,2,2,2,2,2,2,2,3,3,4,4,4,4,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,0,0,0,0,1,1,1,1,1,1,1,1,3,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,0,0,0,0,1,1,1,1,1,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,7,7,7,7,8,8,8,8,8,0,0,0,0,0,0,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,3,4,2,2,2,2,2,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,0,0,0,0,0,1,1,1,2,3,3,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,2,3,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,8,8,0,0,0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,6,6,7,7,7,8,8,8,8,9,0,0,0,0,0,0,1,4,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,8,8,8,8,8,9,9,0,0,0,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,8,8,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8],["21- 40","41-50","41-50","41-50","40-60","&gt;60","41-50","&gt;60","&lt;21","&lt;21","21- 40","&lt;21","21- 40","40-60","40-60","&gt;60","41-50","41-50","41-50","41-50","40-60","&gt;60","21- 40","40-60","&gt;60","&gt;60","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","21- 40","21- 40","41-50","40-60","40-60","&gt;60","21- 40","40-60","&gt;60","21- 40","41-50","41-50","41-50","&lt;21","21- 40","21- 40","41-50","41-50","41-50","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","&gt;60","&lt;21","&lt;21","41-50","40-60","40-60","&gt;60","&lt;21","41-50","41-50","41-50","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","40-60","&gt;60","&gt;60","21- 40","21- 40","40-60","&gt;60","21- 40","21- 40","40-60","&gt;60","21- 40","21- 40","41-50","41-50","40-60","40-60","&gt;60","&lt;21","&lt;21","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","40-60","40-60","&lt;21","&lt;21","&lt;21","&lt;21","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&gt;60","21- 40","41-50","&gt;60","&lt;21","21- 40","41-50","40-60","&lt;21","21- 40","21- 40","21- 40","41-50","21- 40","21- 40","21- 40","41-50","40-60","&gt;60","21- 40","21- 40","41-50","41-50","40-60","&gt;60","&lt;21","40-60","21- 40","21- 40","41-50","40-60","40-60","&gt;60","21- 40","41-50","40-60","&lt;21","21- 40","21- 40","41-50","&gt;60","21- 40","41-50","41-50","40-60","40-60","&lt;21","&lt;21","21- 40","21- 40","40-60","40-60","&lt;21","41-50","41-50","40-60","40-60","&gt;60","&lt;21","21- 40","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","21- 40","41-50","40-60","40-60","&lt;21","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","41-50","&lt;21","40-60","&lt;21","21- 40","41-50","40-60","&gt;60","21- 40","41-50","41-50","&lt;21","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&lt;21","41-50","41-50","41-50","40-60","21- 40","41-50","41-50","40-60","40-60","&gt;60","21- 40","21- 40","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","&gt;60","41-50","41-50","40-60","40-60","&gt;60","&gt;60","21- 40","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&gt;60","21- 40","21- 40","41-50","&lt;21","21- 40","40-60","21- 40","21- 40","21- 40","21- 40","40-60","&gt;60","&gt;60","&lt;21","21- 40","40-60","40-60","40-60","&gt;60","&lt;21","&lt;21","41-50","40-60","40-60","&gt;60","&lt;21","&lt;21","41-50","40-60","&gt;60","&gt;60","&lt;21","40-60","40-60","40-60","40-60","&gt;60","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","40-60","&gt;60","&gt;60","21- 40","40-60","40-60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","41-50","41-50","41-50","40-60","40-60","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","41-50","40-60","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","41-50","&gt;60","&gt;60","&lt;21","21- 40","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","41-50","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","21- 40","41-50","&gt;60","&gt;60","21- 40","41-50","40-60","&gt;60","41-50","40-60","21- 40","21- 40","41-50","41-50","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","41-50","40-60","&gt;60","21- 40","41-50","40-60","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","41-50","41-50","41-50","40-60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","21- 40","41-50","40-60","&gt;60","&lt;21","21- 40","21- 40","41-50","41-50","41-50","40-60","40-60","21- 40","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","41-50","41-50","41-50","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","&lt;21","41-50","40-60","&gt;60","&lt;21","&lt;21","21- 40","41-50","40-60","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","41-50","&lt;21","41-50","40-60","&gt;60","&lt;21","&lt;21","21- 40","41-50","41-50","41-50","&lt;21","21- 40","40-60","40-60","&lt;21","21- 40","40-60","&gt;60","21- 40","41-50","41-50","41-50","&gt;60","&gt;60","21- 40","40-60","40-60","21- 40","21- 40","41-50","40-60","40-60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&gt;60","&gt;60","21- 40","41-50","41-50","41-50","41-50","41-50","40-60","&gt;60","&gt;60","41-50","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","&lt;21","21- 40","21- 40","41-50","40-60","&gt;60","21- 40","41-50","41-50","40-60","&gt;60","&gt;60","&gt;60","&gt;60","&lt;21","40-60","&gt;60","&gt;60","41-50","41-50","40-60","&gt;60","&gt;60","41-50","40-60","&lt;21","21- 40","41-50","&lt;21","21- 40","21- 40","40-60","40-60","&gt;60","&lt;21","21- 40","41-50","41-50","&lt;21","&lt;21","21- 40","40-60","40-60","&gt;60","&gt;60","&gt;60","&lt;21","41-50","41-50","40-60","&gt;60","&gt;60","41-50","41-50","41-50","40-60","40-60","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","41-50","40-60","&gt;60","&lt;21","41-50","41-50","40-60","41-50","40-60","41-50","40-60","40-60","40-60","&lt;21","&lt;21","&lt;21","&lt;21","21- 40","41-50","41-50","40-60","&gt;60","&lt;21","21- 40","41-50","40-60","40-60","&gt;60","&gt;60","&lt;21","&lt;21","21- 40","21- 40","21- 40","21- 40","21- 40","41-50","40-60","40-60","40-60","21- 40","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&lt;21","21- 40","21- 40","21- 40","41-50","40-60","&lt;21","&lt;21","41-50","40-60","40-60","&gt;60","&gt;60","21- 40","41-50","41-50","41-50","41-50","40-60","40-60","21- 40","21- 40","41-50","40-60","40-60","&gt;60","&gt;60"],[131,21,95,9,63,26,9,49,13,2,2,17,17768,1236,980,1173,15071,13,72,237,404,239,66,2506,36,8575,14,2112,25,181,87,271,6,283,31,742,4,57,28,27,68,336,174,388,161,3,500,2721,306,32,1,12335,38,3,24,181,1217,5466,4502,1253,89905,37,23,19,2803,1389,4966,9992,3,712,289,13127,1849,402,3040,8,191,82,96,112,447,798,44,28,1520,1126,4,1,131,228,17,8,291,4,30,6,1,1,67,78,4,2,359,310,3567,10,3,6,11,3144,8465,253,853,338,17888,8306,31,6,3485,268,2717,68,118,296,1328,3,5358,266,1044,59,65,799,10,115,8,40,2,41,4,319,1,6,30,35,35,10,104,3,80,2,124,446,26,637,247,6,24,1,125,108,300,2456,1566,580,1054,5491,9538,307,4,16787,9919,154,95,2687,3359,204,9596,85,7,4,84,51,507,33,3,18,1,5,8,160,1,62,2,2,3,46,22,36,1,322,60,1,8,26,112,30,33,296,63,9,54,268,136,334,115,5,16,85,106,173,19,1173,9390,446,463,15,143,3013,328,8607,198,92,1,39,9068,10,4460,32,80,569,116,504,30,17,89,97,1642,543,73,788,415,4,12,75,1,44,2,25,1,1,1,1,89,5,135,272,2,108,293,321,58,16,9,405,3650,2591,1710,16727,4373,33626,7,601,113,150,14025,13384,10,14,3937,368,10449,808,1,1,72,148,1508,224,2,2272,89,112,8067,129,274,2,4,11,15,4,5,2,45,9,11,14,36,4,36,42,77,2,57,1399,30,200,549,194,4,394,316,472,107,8,27,1308,152,50,174,1537,13,1368,2344,14183,7782,1923,3853,1,203,119,11033,7,781,3268,94,50,41,131,96,2,2,8038,131,384,23,151,26,5352,83,30,12,4,56,96,115,8,9,28,8,78,33,9,8,7,23,1018,519,287,239,15822,964,1486,695,1328,1356,306,969,4,7,340,468,204,117,21328,3382,69,14727,21,6,142,1182,82,53,120,13,48,8,198,3111,471,27,43,17,49,32,9,104,12,14,26,14,8,36,25,2,267,2,122,9,1,1,1,10,11,12,20,65,3496,33,185,782,184,455,6,2,1,58,1157,263,737,37,7,358,180,196,234,4,3786,2421,16022,1,11612,27,313,588,2840,12391,62,68,6363,7,24,80,1,7,1,17,1,1,11,9,76,241,2,18,18,55,62,304,2259,335,44,4006,219,2025,6779,1041,8191,5677,17433,232,1,215,5291,8155,238,12885,1,354,10,1082,15392,28,3,56,6189,12795,12,1266,59,6,1,1648,30,1,6,9,2,3,1,1,1,1,5,327,1,634,731,113,22,245,15,8356,1995,1157,1,38,12999,1846,173,1535,271,714,4,172,17,2113,136,1505,123,16972,969,182,141,881,4438,7903,1,2,30,36,1805,20,3,375,74,131,9,7,7,4,89,256,7,12,5,5,63,457,72,12,1349,1,1349,1153,813,116,13534,1527,11,43,254,770,3999,536,16129,1179,433,10024,6823,180,1158,17,489,521,3514,171,4,68,118,2041,45,205,1,4,1301,17,11,129,385,12,10,6,23,136,5,24,37,9,75,7,2,30,4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>segmento<\/th>\n      <th>tipo<\/th>\n      <th>valor_cliente<\/th>\n      <th>edad_cat<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Tenemos 654 con la info de 9.71693^{5} observaciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># desconectamos spark</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spark_disconnect</span>(sc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="glmer" class="level2">
<h2 class="anchored" data-anchor-id="glmer">glmer</h2>
<p>Hacemos un par de modelos mixtos como en el post anterior, pero en los datos de train</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>modA <span class="ot">&lt;-</span> <span class="fu">glmer</span>(segmento <span class="sc">==</span> <span class="st">"Best"</span> <span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> edad_cat) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> valor_cliente) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tipo),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> train_local, <span class="at">family=</span> binomial, <span class="at">weights=</span> train_local<span class="sc">$</span>n)  </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>modB <span class="ot">&lt;-</span>  <span class="fu">glmer</span>(segmento <span class="sc">==</span> <span class="st">"No_way"</span> <span class="sc">~</span>(<span class="dv">1</span> <span class="sc">|</span> edad_cat) <span class="sc">+</span> (<span class="dv">1</span>  <span class="sc">|</span>valor_cliente) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> tipo),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> train_local, <span class="at">family=</span> binomial, <span class="at">weights=</span> train_local<span class="sc">$</span>n)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos ver el modelo A por ejemplo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modA)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Approximation) [glmerMod]</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: binomial  ( logit )</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: segmento == "Best" ~ (1 | edad_cat) + (1 | valor_cliente) + (1 |  </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     tipo)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: train_local</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Weights: train_local$n</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       AIC       BIC    logLik  deviance  df.resid </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  795616.1  795634.1 -397804.0  795608.1       667 </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Scaled residuals: </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -71.796  -6.426  -1.951   1.760 281.033 </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random effects:</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Groups        Name        Variance Std.Dev.</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  valor_cliente (Intercept) 0.06301  0.2510  </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  edad_cat      (Intercept) 0.35175  0.5931  </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  tipo          (Intercept) 0.01513  0.1230  </span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of obs: 671, groups:  valor_cliente, 10; edad_cat, 5; tipo, 4</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fixed effects:</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -2.1111     0.2854  -7.396 1.41e-13 ***</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">plot_model</span>(modA, <span class="at">type =</span> <span class="st">"re"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:80.0%"></a></p>
</figure>
</div>
</div>
<pre><code>#&gt; 
#&gt; [[2]]</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-10-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" style="width:80.0%"></a></p>
</figure>
</div>
</div>
<pre><code>#&gt; 
#&gt; [[3]]</code></pre>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-10-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" style="width:80.0%"></a></p>
</figure>
</div>
</div>
</div>
<section id="predicciÃ³n-del-glmer" class="level3">
<h3 class="anchored" data-anchor-id="predicciÃ³n-del-glmer">PredicciÃ³n del glmer</h3>
<p>Ahora hacemos predicciÃ³n sobre el conjunto de test, que recordemos tambiÃ©n estÃ¡ en formato de datos agregados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>test_local<span class="sc">$</span>Apredict  <span class="ot">&lt;-</span> <span class="fu">predict</span>(modA, <span class="at">newdata =</span> test_local,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">allow.new.levels=</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type=</span> <span class="st">"response"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>test_local<span class="sc">$</span>Bpredict <span class="ot">&lt;-</span>  <span class="fu">predict</span>(modB, <span class="at">newdata =</span> test_local,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">allow.new.levels=</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type=</span> <span class="st">"response"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>test_local <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(segmento, n, Apredict, Bpredict) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d3304760ff2c9d603690" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d3304760ff2c9d603690">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654"],["Rec","Best","Neut","Rec","Neut","Best","Neut","Neut","Best","Neut","Rec","No_way","No_way","Best","No_way","Rec","No_way","Rec","Best","Rec","No_way","Rec","Best","Best","Best","Neut","Neut","Best","Best","Best","No_way","Neut","Best","Best","No_way","Rec","Best","No_way","No_way","No_way","Rec","No_way","Best","Neut","Rec","Rec","Best","No_way","Best","Rec","Rec","No_way","Neut","Best","Neut","Neut","Rec","Neut","Neut","Neut","No_way","Rec","Best","Best","Best","Best","Neut","Neut","No_way","Best","Neut","Rec","Best","Neut","No_way","Best","No_way","Rec","Neut","Best","Neut","No_way","Best","Rec","No_way","Neut","Rec","Rec","No_way","Neut","Best","Best","Neut","Best","Neut","Best","Neut","No_way","Neut","Rec","No_way","Rec","Best","Best","No_way","Rec","Neut","No_way","No_way","Best","Rec","Neut","Rec","Best","No_way","Rec","Neut","No_way","Neut","Rec","Neut","Best","Neut","Best","Neut","Best","Rec","Best","No_way","Rec","Neut","No_way","Rec","Neut","Rec","Neut","Best","No_way","Rec","Best","Rec","Best","Neut","No_way","Neut","Best","Best","Neut","No_way","Neut","Neut","Best","Rec","Neut","No_way","Rec","Best","Rec","Rec","Best","Rec","No_way","Neut","No_way","Best","No_way","Rec","Best","Rec","Neut","Rec","Rec","Best","Best","No_way","No_way","Rec","Rec","Best","Neut","Neut","No_way","No_way","Rec","Neut","Neut","Rec","Rec","Rec","Best","No_way","Best","Rec","Best","Rec","No_way","Neut","No_way","No_way","Neut","No_way","Rec","Neut","No_way","Rec","No_way","No_way","No_way","Neut","Rec","No_way","Best","Best","Rec","Neut","Rec","Rec","No_way","Neut","Rec","Rec","Neut","Neut","Best","Neut","Neut","Best","No_way","No_way","No_way","Rec","Best","No_way","Best","Rec","Rec","No_way","Best","Neut","Neut","Best","Neut","Rec","Neut","No_way","No_way","Neut","Rec","Neut","Neut","Rec","Rec","No_way","Best","Rec","Best","Rec","No_way","Rec","No_way","Neut","No_way","Best","Rec","No_way","No_way","Best","No_way","Rec","Rec","Best","Rec","Rec","Best","Best","Neut","No_way","No_way","Neut","No_way","Best","Neut","Best","Neut","No_way","No_way","No_way","Best","Best","No_way","Rec","No_way","No_way","No_way","Rec","No_way","Best","No_way","No_way","Best","Neut","No_way","Rec","No_way","Rec","Rec","Rec","Neut","Neut","Neut","Rec","Neut","Rec","No_way","Best","No_way","No_way","Best","Best","No_way","No_way","Best","Best","No_way","Best","Best","Neut","Best","Neut","Neut","Rec","Neut","Rec","Rec","No_way","Best","Neut","Best","Neut","Neut","Rec","No_way","Best","Neut","No_way","Best","Neut","Rec","Neut","Rec","Rec","Rec","No_way","Best","Neut","Rec","Best","Neut","Rec","Neut","No_way","Neut","No_way","No_way","Rec","No_way","Rec","Rec","Neut","Best","No_way","Best","No_way","Rec","Neut","Rec","Best","No_way","No_way","No_way","Best","Neut","Best","Neut","Neut","No_way","Neut","No_way","No_way","No_way","Rec","Rec","No_way","No_way","No_way","Best","Best","Neut","Best","Neut","No_way","Rec","Best","Neut","No_way","Best","No_way","Neut","No_way","Neut","Neut","No_way","Rec","No_way","Rec","Rec","Rec","Best","Rec","No_way","Rec","Rec","Best","Neut","Best","No_way","Neut","No_way","Neut","No_way","Best","Best","No_way","No_way","Rec","Neut","Rec","Neut","No_way","Best","No_way","Rec","Neut","Neut","Best","Neut","Neut","No_way","Neut","No_way","No_way","Best","Neut","Rec","Neut","Rec","Neut","Best","Best","Best","Neut","Rec","Rec","Best","Neut","Rec","Rec","Best","Best","Neut","Neut","Neut","Best","No_way","Neut","Best","Neut","Neut","Best","Neut","Neut","Best","No_way","Neut","No_way","Best","No_way","Neut","No_way","Neut","Best","Best","Neut","Rec","Rec","Rec","Rec","Best","Best","Neut","No_way","Rec","No_way","Best","Best","Neut","No_way","No_way","No_way","No_way","Rec","No_way","No_way","No_way","No_way","Neut","Neut","Best","Best","Rec","Neut","Neut","Best","Rec","No_way","Rec","Neut","Best","Best","Neut","Rec","No_way","Neut","Neut","Rec","Neut","No_way","Best","Rec","Neut","Neut","Neut","Neut","No_way","No_way","Rec","Neut","Neut","Best","Rec","No_way","Best","Neut","Best","Rec","Neut","Neut","Neut","Best","Rec","Neut","Neut","Rec","Best","Neut","Rec","Neut","Neut","No_way","Neut","Neut","No_way","Best","Neut","Neut","No_way","Rec","Neut","No_way","Rec","Best","No_way","Best","Neut","Best","No_way","No_way","Neut","Best","No_way","Best","Best","No_way","Best","Best","Neut","No_way","Rec","Best","No_way","Best","No_way","No_way","No_way","No_way","Best","Neut","No_way","No_way","No_way","No_way","Best","Best","Best","No_way","No_way","Rec","Neut","Neut","Rec","Best","Best","Rec","No_way","Best","No_way","Rec","Neut","Best","Neut","No_way","Best","No_way","Best","Best","No_way","Best","Rec","No_way","No_way","Best","Best","Best","Neut","No_way","Best","No_way","No_way","Neut","Rec","Neut","Neut","Best","Neut"],[131,21,95,9,63,26,9,49,13,2,2,17,17768,1236,980,1173,15071,13,72,237,404,239,66,2506,36,8575,14,2112,25,181,87,271,6,283,31,742,4,57,28,27,68,336,174,388,161,3,500,2721,306,32,1,12335,38,3,24,181,1217,5466,4502,1253,89905,37,23,19,2803,1389,4966,9992,3,712,289,13127,1849,402,3040,8,191,82,96,112,447,798,44,28,1520,1126,4,1,131,228,17,8,291,4,30,6,1,1,67,78,4,2,359,310,3567,10,3,6,11,3144,8465,253,853,338,17888,8306,31,6,3485,268,2717,68,118,296,1328,3,5358,266,1044,59,65,799,10,115,8,40,2,41,4,319,1,6,30,35,35,10,104,3,80,2,124,446,26,637,247,6,24,1,125,108,300,2456,1566,580,1054,5491,9538,307,4,16787,9919,154,95,2687,3359,204,9596,85,7,4,84,51,507,33,3,18,1,5,8,160,1,62,2,2,3,46,22,36,1,322,60,1,8,26,112,30,33,296,63,9,54,268,136,334,115,5,16,85,106,173,19,1173,9390,446,463,15,143,3013,328,8607,198,92,1,39,9068,10,4460,32,80,569,116,504,30,17,89,97,1642,543,73,788,415,4,12,75,1,44,2,25,1,1,1,1,89,5,135,272,2,108,293,321,58,16,9,405,3650,2591,1710,16727,4373,33626,7,601,113,150,14025,13384,10,14,3937,368,10449,808,1,1,72,148,1508,224,2,2272,89,112,8067,129,274,2,4,11,15,4,5,2,45,9,11,14,36,4,36,42,77,2,57,1399,30,200,549,194,4,394,316,472,107,8,27,1308,152,50,174,1537,13,1368,2344,14183,7782,1923,3853,1,203,119,11033,7,781,3268,94,50,41,131,96,2,2,8038,131,384,23,151,26,5352,83,30,12,4,56,96,115,8,9,28,8,78,33,9,8,7,23,1018,519,287,239,15822,964,1486,695,1328,1356,306,969,4,7,340,468,204,117,21328,3382,69,14727,21,6,142,1182,82,53,120,13,48,8,198,3111,471,27,43,17,49,32,9,104,12,14,26,14,8,36,25,2,267,2,122,9,1,1,1,10,11,12,20,65,3496,33,185,782,184,455,6,2,1,58,1157,263,737,37,7,358,180,196,234,4,3786,2421,16022,1,11612,27,313,588,2840,12391,62,68,6363,7,24,80,1,7,1,17,1,1,11,9,76,241,2,18,18,55,62,304,2259,335,44,4006,219,2025,6779,1041,8191,5677,17433,232,1,215,5291,8155,238,12885,1,354,10,1082,15392,28,3,56,6189,12795,12,1266,59,6,1,1648,30,1,6,9,2,3,1,1,1,1,5,327,1,634,731,113,22,245,15,8356,1995,1157,1,38,12999,1846,173,1535,271,714,4,172,17,2113,136,1505,123,16972,969,182,141,881,4438,7903,1,2,30,36,1805,20,3,375,74,131,9,7,7,4,89,256,7,12,5,5,63,457,72,12,1349,1,1349,1153,813,116,13534,1527,11,43,254,770,3999,536,16129,1179,433,10024,6823,180,1158,17,489,521,3514,171,4,68,118,2041,45,205,1,4,1301,17,11,129,385,12,10,6,23,136,5,24,37,9,75,7,2,30,4],[0.223493070762821,0.135897819041265,0.156685680647709,0.135897819041265,0.116130642005479,0.0697802924388859,0.116783827357181,0.0442108229174957,0.178115837051445,0.178115837051445,0.116478904479496,0.202413430240201,0.116478904479496,0.0644150487138076,0.0730147608245953,0.0430350564361705,0.0916993431723813,0.0916993431723813,0.072881100157202,0.0831802219872318,0.0526626903724307,0.0353361728268578,0.124874912555725,0.080262432093808,0.0408104839120354,0.0474592065507767,0.257815052421354,0.171116608250948,0.101369758933972,0.117594745815585,0.0738779007977746,0.0510583477717903,0.150575946576928,0.193277536592288,0.131259980297695,0.111206883941588,0.0965325807775698,0.0587732892551201,0.179072574651137,0.117701782793239,0.0707745679602049,0.201013206646991,0.175295888460693,0.175295888460693,0.175295888460693,0.260792094190085,0.154885943469052,0.154885943469052,0.119212710401913,0.116783827357181,0.119212710401913,0.0518146059311177,0.0506799037168261,0.162976302764653,0.202413430240201,0.100390358889575,0.131055730002683,0.0887228860212104,0.0644150487138076,0.0369820648261805,0.0369820648261805,0.0322021462777043,0.208331999877676,0.187009835220712,0.103538522835095,0.0666356617719093,0.0666356617719093,0.044553724970347,0.194895019939374,0.0849774564142711,0.072881100157202,0.0960405460980652,0.0411312810276307,0.0307621898491608,0.0361404137009722,0.219464663205711,0.124874912555725,0.124874912555725,0.069352784620127,0.0417339282364618,0.0417339282364618,0.171116608250948,0.149869939046138,0.0738779007977746,0.0579853949857011,0.193277536592288,0.169843079644805,0.0985872903981845,0.0666734760375409,0.203468370560995,0.182529214869176,0.141555629373774,0.158706974577246,0.104431757705819,0.104431757705819,0.0610689261659599,0.297423852383802,0.263804904212833,0.0697802924388859,0.0790357799181614,0.207001691884245,0.207001691884245,0.151855551141793,0.0986910681690236,0.0873521637027417,0.202413430240201,0.183487388989005,0.162976302764653,0.208331999877676,0.135241594373205,0.135241594373205,0.117816197374011,0.0651987071695471,0.038295676714632,0.044553724970347,0.044553724970347,0.194895019939374,0.171306091770505,0.11170538729428,0.10941046102938,0.0849774564142711,0.0602904671793808,0.0602904671793808,0.0361404137009722,0.0361404137009722,0.197287045497423,0.143174878278194,0.0973660197571291,0.0708743520807467,0.060652471431311,0.0408104839120354,0.0417339282364618,0.0417339282364618,0.132506920240684,0.117594745815585,0.0499393347949369,0.287312148422769,0.169843079644805,0.131259980297695,0.111206883941588,0.300613523455699,0.179072574651137,0.182529214869176,0.182529214869176,0.141555629373774,0.175568673653646,0.223493070762821,0.197291006269533,0.175295888460693,0.113756443946545,0.0790357799181614,0.173326323573643,0.134298831996596,0.134079740389461,0.134079740389461,0.0749454599318828,0.0442108229174957,0.178115837051445,0.0630227468147279,0.100390358889575,0.114098505585439,0.0868539564734493,0.0730147608245953,0.055069547636266,0.0378222969939627,0.135241594373205,0.103538522835095,0.0651987071695471,0.194895019939374,0.12576986617466,0.12576986617466,0.072881100157202,0.0353361728268578,0.143174878278194,0.109848335941381,0.0953340713376099,0.080262432093808,0.069352784620127,0.257815052421354,0.232918465335652,0.149869939046138,0.132506920240684,0.0861243311433087,0.0843050756403718,0.260567139019477,0.131259980297695,0.133944280160365,0.0847330046930338,0.0965325807775698,0.0666734760375409,0.273104806859963,0.203468370560995,0.158958920769293,0.158958920769293,0.179072574651137,0.104431757705819,0.0624209397119672,0.0707745679602049,0.326282589352318,0.223493070762821,0.223493070762821,0.197291006269533,0.135897819041265,0.113756443946545,0.130670329886097,0.235699319547513,0.231520944759556,0.173326323573643,0.102790491502821,0.102790491502821,0.0749454599318828,0.0588378924747827,0.0506799037168261,0.0588378924747827,0.0868539564734493,0.162976302764653,0.0616263774864147,0.181558093756195,0.114098505585439,0.0868539564734493,0.055069547636266,0.0322021462777043,0.120263628107293,0.0897738918599457,0.0787284678950094,0.174644708820726,0.0962043859050164,0.11170538729428,0.072881100157202,0.0698815971048883,0.0602904671793808,0.0307621898491608,0.193617122985615,0.0836674271986272,0.109848335941381,0.0973660197571291,0.080262432093808,0.132506920240684,0.101369758933972,0.117594745815585,0.0861243311433087,0.0861243311433087,0.0499393347949369,0.150575946576928,0.173159141670232,0.193277536592288,0.150334912203726,0.150334912203726,0.0985872903981845,0.0666734760375409,0.0666734760375409,0.0502023882887416,0.0502023882887416,0.158706974577246,0.138743231108154,0.117701782793239,0.0898380149359968,0.0624209397119672,0.0533482522480428,0.156827341651185,0.139845361267427,0.137061517039716,0.201013206646991,0.100084750731441,0.068280486722529,0.0697802924388859,0.0597060632245081,0.134298831996596,0.173326323573643,0.134079740389461,0.181558093756195,0.120263628107293,0.0666356617719093,0.114098505585439,0.116478904479496,0.131055730002683,0.114098505585439,0.0644150487138076,0.0378222969939627,0.0378222969939627,0.183487388989005,0.103713686211031,0.0569876123382445,0.0651987071695471,0.0666356617719093,0.0333518543666367,0.174644708820726,0.194895019939374,0.0960405460980652,0.0602904671793808,0.0698815971048883,0.0353361728268578,0.219464663205711,0.172212513669191,0.0953340713376099,0.060652471431311,0.0474592065507767,0.0408104839120354,0.22877463224218,0.0973208503066482,0.0738779007977746,0.0843050756403718,0.0973208503066482,0.0435604469414849,0.193277536592288,0.150575946576928,0.115759417613032,0.0965325807775698,0.0502023882887416,0.0574954374635102,0.0574954374635102,0.300613523455699,0.203468370560995,0.0898380149359968,0.0624209397119672,0.0610689261659599,0.197291006269533,0.113756443946545,0.116130642005479,0.0597060632245081,0.0790357799181614,0.207001691884245,0.134298831996596,0.151855551141793,0.102790491502821,0.116783827357181,0.119212710401913,0.0873521637027417,0.0855093987604233,0.0873521637027417,0.0986910681690236,0.0518146059311177,0.0369820648261805,0.0391645403693102,0.178115837051445,0.131055730002683,0.0761377389737393,0.055069547636266,0.055069547636266,0.0430350564361705,0.208331999877676,0.117816197374011,0.0916993431723813,0.103538522835095,0.103538522835095,0.044553724970347,0.0391645403693102,0.151903362023087,0.10941046102938,0.0526626903724307,0.0411312810276307,0.219464663205711,0.127447792247088,0.109848335941381,0.0953340713376099,0.0836674271986272,0.069352784620127,0.035554012083575,0.0408104839120354,0.22877463224218,0.257815052421354,0.171116608250948,0.149869939046138,0.152867848803299,0.132506920240684,0.115194516413424,0.0435604469414849,0.0579853949857011,0.173159141670232,0.133944280160365,0.0847330046930338,0.0574954374635102,0.141555629373774,0.117701782793239,0.201013206646991,0.175568673653646,0.153626476878186,0.153626476878186,0.100084750731441,0.130670329886097,0.0790357799181614,0.068280486722529,0.068280486722529,0.260792094190085,0.151855551141793,0.116783827357181,0.0986910681690236,0.0588378924747827,0.100390358889575,0.0887228860212104,0.0730147608245953,0.117816197374011,0.0787284678950094,0.0897738918599457,0.0651987071695471,0.0333518543666367,0.0391645403693102,0.151903362023087,0.174644708820726,0.0962043859050164,0.10941046102938,0.0962043859050164,0.0831802219872318,0.0960405460980652,0.0849774564142711,0.0526626903724307,0.0411312810276307,0.219464663205711,0.197287045497423,0.110032863837125,0.127447792247088,0.110032863837125,0.110032863837125,0.0836674271986272,0.0708743520807467,0.035554012083575,0.257815052421354,0.152867848803299,0.171116608250948,0.117594745815585,0.101369758933972,0.115194516413424,0.0843050756403718,0.0843050756403718,0.173159141670232,0.150575946576928,0.133944280160365,0.115759417613032,0.0847330046930338,0.0574954374635102,0.0587732892551201,0.138743231108154,0.158706974577246,0.138743231108154,0.122483560183901,0.117701782793239,0.102269060051596,0.0707745679602049,0.0533482522480428,0.326282589352318,0.292570115557689,0.153626476878186,0.100084750731441,0.0597060632245081,0.235699319547513,0.235699319547513,0.134298831996596,0.119212710401913,0.0749454599318828,0.0986910681690236,0.0855093987604233,0.0518146059311177,0.0588378924747827,0.0442108229174957,0.15808895078881,0.0887228860212104,0.181558093756195,0.100220180715377,0.0630227468147279,0.0430350564361705,0.208331999877676,0.183487388989005,0.103713686211031,0.0787284678950094,0.0897738918599457,0.0787284678950094,0.171306091770505,0.12576986617466,0.0698815971048883,0.0698815971048883,0.172212513669191,0.143174878278194,0.060652471431311,0.035554012083575,0.152867848803299,0.132290305196997,0.132290305196997,0.115194516413424,0.0510583477717903,0.0579853949857011,0.169843079644805,0.0985872903981845,0.0985872903981845,0.179072574651137,0.158958920769293,0.122483560183901,0.102269060051596,0.0885357485720931,0.297423852383802,0.175568673653646,0.197291006269533,0.156685680647709,0.130670329886097,0.0597060632245081,0.0506799037168261,0.0361404137009722,0.100390358889575,0.0761377389737393,0.0868539564734493,0.100220180715377,0.0761377389737393,0.0761377389737393,0.0630227468147279,0.0322021462777043,0.0369820648261805,0.0916993431723813,0.0569876123382445,0.0755079097022074,0.038295676714632,0.0391645403693102,0.0333518543666367,0.151903362023087,0.0962043859050164,0.12576986617466,0.0960405460980652,0.0526626903724307,0.0411312810276307,0.193617122985615,0.127447792247088,0.127447792247088,0.0973660197571291,0.080262432093808,0.035554012083575,0.152867848803299,0.101369758933972,0.132290305196997,0.0973208503066482,0.0435604469414849,0.0579853949857011,0.0435604469414849,0.0510583477717903,0.287312148422769,0.111206883941588,0.0587732892551201,0.0587732892551201,0.122483560183901,0.122483560183901,0.0898380149359968,0.0610689261659599,0.0610689261659599,0.107196863795155,0.0782623052264625,0.326282589352318,0.175568673653646,0.156685680647709,0.231520944759556,0.173326323573643,0.154885943469052,0.0855093987604233,0.0855093987604233,0.0442108229174957,0.202413430240201,0.116478904479496,0.0887228860212104,0.100220180715377,0.162976302764653,0.187009835220712,0.135241594373205,0.0755079097022074,0.0569876123382445,0.0333518543666367,0.038295676714632,0.038295676714632,0.171306091770505,0.0831802219872318,0.0849774564142711,0.0616263774864147,0.0353361728268578,0.0307621898491608,0.0836674271986272,0.109848335941381,0.0973660197571291,0.0708743520807467,0.060652471431311,0.0708743520807467,0.0474592065507767,0.0474592065507767,0.204468841987113,0.232918465335652,0.149869939046138,0.115194516413424,0.0973208503066482,0.0499393347949369,0.287312148422769,0.150334912203726,0.133944280160365,0.111206883941588,0.138743231108154,0.102269060051596,0.135897819041265,0.100084750731441,0.130670329886097,0.116130642005479,0.260792094190085,0.231520944759556,0.207001691884245,0.260792094190085,0.151855551141793,0.134079740389461,0.102790491502821,0.0749454599318828,0.0506799037168261,0.15808895078881,0.131055730002683,0.100220180715377,0.0730147608245953,0.0630227468147279,0.0322021462777043,0.0430350564361705,0.183487388989005,0.187009835220712,0.103713686211031,0.117816197374011,0.120263628107293,0.103713686211031,0.120263628107293,0.0897738918599457,0.0569876123382445,0.0755079097022074,0.0755079097022074,0.10941046102938,0.11170538729428,0.11170538729428,0.0831802219872318,0.0616263774864147,0.0616263774864147,0.0307621898491608,0.197287045497423,0.110032863837125,0.124874912555725,0.143174878278194,0.0953340713376099,0.069352784620127,0.22877463224218,0.232918465335652,0.132290305196997,0.0738779007977746,0.0861243311433087,0.0499393347949369,0.0510583477717903,0.169843079644805,0.115759417613032,0.131259980297695,0.115759417613032,0.150334912203726,0.0847330046930338,0.0965325807775698,0.203468370560995,0.158958920769293,0.158706974577246,0.0898380149359968,0.102269060051596,0.0707745679602049,0.0533482522480428],[0.131964520311865,0.508766208131462,0.538024875663565,0.508766208131462,0.621096491208384,0.782184035041159,0.814551613421254,0.879229789773592,0.664763538824856,0.664763538824856,0.625038136138412,0.176158807446352,0.625038136138412,0.762263718660036,0.363864156357612,0.556162778416625,0.598010925882594,0.598010925882594,0.481131357316166,0.63303051248001,0.566184505909846,0.841747164722475,0.416669865354819,0.129036588536005,0.750619278391936,0.245035190913174,0.0306970362579208,0.042184876333947,0.230795453717126,0.252277968623418,0.296918742252479,0.509885219096012,0.17150472461254,0.0398702840384712,0.344812910149316,0.0739667230734632,0.425531148860644,0.4951756298278,0.396445979906995,0.119903885550685,0.229859275153007,0.4601006725741,0.172021407914453,0.172021407914453,0.172021407914453,0.199491554771234,0.660181925655753,0.660181925655753,0.726400501664858,0.814551613421254,0.726400501664858,0.891144178087013,0.931240776853257,0.410405228748565,0.176158807446352,0.597164184214684,0.229210631553918,0.694940515503894,0.762263718660036,0.920765259402207,0.920765259402207,0.862004561550534,0.122525660620546,0.439063141623999,0.209725967411701,0.676776103096505,0.676776103096505,0.450034275949406,0.0891468685270937,0.510452200823634,0.481131357316166,0.15683779691219,0.364496319564678,0.740877690427715,0.762758107317973,0.0524775921974467,0.416669865354819,0.416669865354819,0.578759518898599,0.645311410286881,0.645311410286881,0.042184876333947,0.28999550843728,0.296918742252479,0.156537996353039,0.0398702840384712,0.278030922321388,0.309270336841454,0.148924649880489,0.066144319258495,0.284200366087102,0.351742262805504,0.0882532473292578,0.433010566070385,0.433010566070385,0.734598663639583,0.379951172286197,0.352725393451287,0.782184035041159,0.39047344011046,0.554028631371437,0.554028631371437,0.762698273718682,0.399988067225744,0.78888995300691,0.176158807446352,0.56425766612639,0.410405228748565,0.122525660620546,0.162613553024841,0.162613553024841,0.642969945371287,0.775985014796792,0.883567391870715,0.450034275949406,0.450034275949406,0.0891468685270937,0.475791615601746,0.432780366266888,0.557965400786061,0.510452200823634,0.708281236327381,0.708281236327381,0.762758107317973,0.762758107317973,0.236908815921919,0.0715150525297121,0.371087797605426,0.453697578952855,0.424807857080815,0.750619278391936,0.645311410286881,0.645311410286881,0.180028234518527,0.252277968623418,0.632503289560321,0.0289936767587042,0.278030922321388,0.344812910149316,0.0739667230734632,0.0484619369263968,0.396445979906995,0.284200366087102,0.284200366087102,0.351742262805504,0.431124989790131,0.131964520311865,0.585037465795112,0.172021407914453,0.730592332875849,0.39047344011046,0.257374994031737,0.633388138948676,0.321404241924784,0.321404241924784,0.768688755010696,0.879229789773592,0.664763538824856,0.841383151482496,0.597164184214684,0.733882963336993,0.790301625159836,0.363864156357612,0.740353226468982,0.875377413028634,0.162613553024841,0.209725967411701,0.775985014796792,0.0891468685270937,0.119804969363261,0.119804969363261,0.481131357316166,0.841747164722475,0.0715150525297121,0.0952360879564688,0.49396830421079,0.129036588536005,0.578759518898599,0.0306970362579208,0.150760470010485,0.28999550843728,0.180028234518527,0.321979718906777,0.43997497568859,0.143380351668078,0.344812910149316,0.241340571107798,0.284783087880449,0.425531148860644,0.148924649880489,0.222088141340243,0.066144319258495,0.260948197249442,0.260948197249442,0.396445979906995,0.433010566070385,0.625897344701307,0.229859275153007,0.0985431552498602,0.131964520311865,0.131964520311865,0.585037465795112,0.508766208131462,0.730592332875849,0.226258927816409,0.582802087517118,0.697983109912189,0.257374994031737,0.702474850191581,0.702474850191581,0.768688755010696,0.593564307550526,0.931240776853257,0.593564307550526,0.790301625159836,0.410405228748565,0.594747355496495,0.545169078851664,0.733882963336993,0.790301625159836,0.740353226468982,0.862004561550534,0.521200529241822,0.71107466493826,0.569511604299536,0.354267207136019,0.404237010938269,0.432780366266888,0.481131357316166,0.207487678016666,0.708281236327381,0.740877690427715,0.339330942425266,0.344144626512344,0.0952360879564688,0.371087797605426,0.129036588536005,0.180028234518527,0.230795453717126,0.252277968623418,0.321979718906777,0.321979718906777,0.632503289560321,0.17150472461254,0.188823186250955,0.0398702840384712,0.0537020659268761,0.0537020659268761,0.309270336841454,0.148924649880489,0.148924649880489,0.465897179372571,0.465897179372571,0.0882532473292578,0.473035028771888,0.119903885550685,0.404462854316633,0.625897344701307,0.598046189509104,0.158674360091167,0.513905757384952,0.636235570447589,0.4601006725741,0.593120267842866,0.855926949572774,0.782184035041159,0.76153511524706,0.633388138948676,0.257374994031737,0.321404241924784,0.545169078851664,0.521200529241822,0.676776103096505,0.733882963336993,0.625038136138412,0.229210631553918,0.733882963336993,0.762263718660036,0.875377413028634,0.875377413028634,0.56425766612639,0.491882630309762,0.650598248756772,0.775985014796792,0.676776103096505,0.803119185271398,0.354267207136019,0.0891468685270937,0.15683779691219,0.708281236327381,0.207487678016666,0.841747164722475,0.0524775921974467,0.216356356891825,0.49396830421079,0.424807857080815,0.245035190913174,0.750619278391936,0.227018436099801,0.0780997079361339,0.296918742252479,0.43997497568859,0.0780997079361339,0.480564973185432,0.0398702840384712,0.17150472461254,0.220514747131664,0.425531148860644,0.465897179372571,0.618721918048387,0.618721918048387,0.0484619369263968,0.066144319258495,0.404462854316633,0.625897344701307,0.734598663639583,0.585037465795112,0.730592332875849,0.621096491208384,0.76153511524706,0.39047344011046,0.554028631371437,0.633388138948676,0.762698273718682,0.702474850191581,0.814551613421254,0.726400501664858,0.78888995300691,0.860766670243188,0.78888995300691,0.399988067225744,0.891144178087013,0.920765259402207,0.821013608620167,0.664763538824856,0.229210631553918,0.669515407704631,0.740353226468982,0.740353226468982,0.556162778416625,0.122525660620546,0.642969945371287,0.598010925882594,0.209725967411701,0.209725967411701,0.450034275949406,0.821013608620167,0.327908550175766,0.557965400786061,0.566184505909846,0.364496319564678,0.0524775921974467,0.301559194230394,0.0952360879564688,0.49396830421079,0.344144626512344,0.578759518898599,0.618023522682875,0.750619278391936,0.227018436099801,0.0306970362579208,0.042184876333947,0.28999550843728,0.198001697702382,0.180028234518527,0.358225403618954,0.480564973185432,0.156537996353039,0.188823186250955,0.241340571107798,0.284783087880449,0.618721918048387,0.351742262805504,0.119903885550685,0.4601006725741,0.431124989790131,0.658320509721456,0.658320509721456,0.593120267842866,0.226258927816409,0.39047344011046,0.855926949572774,0.855926949572774,0.199491554771234,0.762698273718682,0.814551613421254,0.399988067225744,0.593564307550526,0.597164184214684,0.694940515503894,0.363864156357612,0.642969945371287,0.569511604299536,0.71107466493826,0.775985014796792,0.803119185271398,0.821013608620167,0.327908550175766,0.354267207136019,0.404237010938269,0.557965400786061,0.404237010938269,0.63303051248001,0.15683779691219,0.510452200823634,0.566184505909846,0.364496319564678,0.0524775921974467,0.236908815921919,0.277437262181115,0.301559194230394,0.277437262181115,0.277437262181115,0.344144626512344,0.453697578952855,0.618023522682875,0.0306970362579208,0.198001697702382,0.042184876333947,0.252277968623418,0.230795453717126,0.358225403618954,0.43997497568859,0.43997497568859,0.188823186250955,0.17150472461254,0.241340571107798,0.220514747131664,0.284783087880449,0.618721918048387,0.4951756298278,0.473035028771888,0.0882532473292578,0.473035028771888,0.325476778524501,0.119903885550685,0.558196659814647,0.229859275153007,0.598046189509104,0.0985431552498602,0.503417333246292,0.658320509721456,0.593120267842866,0.76153511524706,0.582802087517118,0.582802087517118,0.633388138948676,0.726400501664858,0.768688755010696,0.399988067225744,0.860766670243188,0.891144178087013,0.593564307550526,0.879229789773592,0.515955808175622,0.694940515503894,0.545169078851664,0.288959540829257,0.841383151482496,0.556162778416625,0.122525660620546,0.56425766612639,0.491882630309762,0.569511604299536,0.71107466493826,0.569511604299536,0.475791615601746,0.119804969363261,0.207487678016666,0.207487678016666,0.216356356891825,0.0715150525297121,0.424807857080815,0.618023522682875,0.198001697702382,0.0567721558026899,0.0567721558026899,0.358225403618954,0.509885219096012,0.156537996353039,0.278030922321388,0.309270336841454,0.309270336841454,0.396445979906995,0.260948197249442,0.325476778524501,0.558196659814647,0.266201193904041,0.379951172286197,0.431124989790131,0.585037465795112,0.538024875663565,0.226258927816409,0.76153511524706,0.931240776853257,0.762758107317973,0.597164184214684,0.669515407704631,0.790301625159836,0.288959540829257,0.669515407704631,0.669515407704631,0.841383151482496,0.862004561550534,0.920765259402207,0.598010925882594,0.650598248756772,0.271946955343463,0.883567391870715,0.821013608620167,0.803119185271398,0.327908550175766,0.404237010938269,0.119804969363261,0.15683779691219,0.566184505909846,0.364496319564678,0.339330942425266,0.301559194230394,0.301559194230394,0.371087797605426,0.129036588536005,0.618023522682875,0.198001697702382,0.230795453717126,0.0567721558026899,0.0780997079361339,0.480564973185432,0.156537996353039,0.480564973185432,0.509885219096012,0.0289936767587042,0.0739667230734632,0.4951756298278,0.4951756298278,0.325476778524501,0.325476778524501,0.404462854316633,0.734598663639583,0.734598663639583,0.590968005361232,0.670352462412455,0.0985431552498602,0.431124989790131,0.538024875663565,0.697983109912189,0.257374994031737,0.660181925655753,0.860766670243188,0.860766670243188,0.879229789773592,0.176158807446352,0.625038136138412,0.694940515503894,0.288959540829257,0.410405228748565,0.439063141623999,0.162613553024841,0.271946955343463,0.650598248756772,0.803119185271398,0.883567391870715,0.883567391870715,0.475791615601746,0.63303051248001,0.510452200823634,0.594747355496495,0.841747164722475,0.740877690427715,0.344144626512344,0.0952360879564688,0.371087797605426,0.453697578952855,0.424807857080815,0.453697578952855,0.245035190913174,0.245035190913174,0.136346251577166,0.150760470010485,0.28999550843728,0.358225403618954,0.0780997079361339,0.632503289560321,0.0289936767587042,0.0537020659268761,0.241340571107798,0.0739667230734632,0.473035028771888,0.558196659814647,0.508766208131462,0.593120267842866,0.226258927816409,0.621096491208384,0.199491554771234,0.697983109912189,0.554028631371437,0.199491554771234,0.762698273718682,0.321404241924784,0.702474850191581,0.768688755010696,0.931240776853257,0.515955808175622,0.229210631553918,0.288959540829257,0.363864156357612,0.841383151482496,0.862004561550534,0.556162778416625,0.56425766612639,0.439063141623999,0.491882630309762,0.642969945371287,0.521200529241822,0.491882630309762,0.521200529241822,0.71107466493826,0.650598248756772,0.271946955343463,0.271946955343463,0.557965400786061,0.432780366266888,0.432780366266888,0.63303051248001,0.594747355496495,0.594747355496495,0.740877690427715,0.236908815921919,0.277437262181115,0.416669865354819,0.0715150525297121,0.49396830421079,0.578759518898599,0.227018436099801,0.150760470010485,0.0567721558026899,0.296918742252479,0.321979718906777,0.632503289560321,0.509885219096012,0.278030922321388,0.220514747131664,0.344812910149316,0.220514747131664,0.0537020659268761,0.284783087880449,0.425531148860644,0.066144319258495,0.260948197249442,0.0882532473292578,0.404462854316633,0.558196659814647,0.229859275153007,0.598046189509104]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>segmento<\/th>\n      <th>n<\/th>\n      <th>Apredict<\/th>\n      <th>Bpredict<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="auc" class="level3">
<h3 class="anchored" data-anchor-id="auc">AUC</h3>
<p>Si calculamos el AUC con las librerÃ­as normales no se va a tener en cuenta que tenemos datos agrupados, sino que considera cada fila como una observaciÃ³n. En este caso los AUCâs son como si fuera un modelo aleatorio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pROC<span class="sc">::</span><span class="fu">auc</span>(test_local<span class="sc">$</span>segmento<span class="sc">==</span><span class="st">"Best"</span>, test_local<span class="sc">$</span>Apredict)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Area under the curve: 0.5024</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>pROC<span class="sc">::</span><span class="fu">auc</span>(test_local<span class="sc">$</span>segmento<span class="sc">==</span><span class="st">"No_way"</span>, test_local<span class="sc">$</span>Bpredict)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Area under the curve: 0.5029</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con los datos agregados se tiene por ejemplo que si en una fila n vale 1000 y la probabilidad de A es 0.2, la estimaciÃ³n de gente en segmento âBestâ serÃ­a de 200, y podrÃ­amos calcular un test de bondad de ajuste de la Chi de Pearson, para comparar la frecuencia observada con la esperada.</p>
<p><span class="math display">\[\chi^2 = \sum_i\dfrac{(observada_i- estimada_i)^2}{estimada_i}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>test_local <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(segmento <span class="sc">==</span> <span class="st">"Best"</span> <span class="sc">&amp;</span> n <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(segmento, n, Apredict) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>( <span class="sc">-</span> Apredict) <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">A_estimate_num =</span> Apredict <span class="sc">*</span> n) <span class="sc">|&gt;</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-cfd8414b274a84f078f7" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cfd8414b274a84f078f7">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74"],["Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best","Best"],[104,283,174,446,2112,500,198,359,375,2687,3144,457,2840,1308,354,3786,3999,306,770,181,200,3650,405,1158,319,3268,180,254,2803,108,1157,310,266,2272,143,3937,2344,446,1995,194,304,116,113,712,117,2506,180,1846,813,182,2421,160,1389,307,1236,263,521,268,1266,113,184,136,1508,1923,737,112,1849,969,338,1054,2025,296,306,219],[0.223493070762821,0.193277536592288,0.175295888460693,0.173326323573643,0.171116608250948,0.154885943469052,0.152867848803299,0.151855551141793,0.150334912203726,0.143174878278194,0.135241594373205,0.134079740389461,0.132290305196997,0.131055730002683,0.127447792247088,0.12576986617466,0.120263628107293,0.119212710401913,0.117816197374011,0.117594745815585,0.116783827357181,0.116478904479496,0.114098505585439,0.11170538729428,0.111206883941588,0.109848335941381,0.10941046102938,0.103713686211031,0.103538522835095,0.100390358889575,0.100220180715377,0.0986910681690236,0.0973660197571291,0.0973208503066482,0.0962043859050164,0.0960405460980652,0.0916993431723813,0.0897738918599457,0.0887228860212104,0.0873521637027417,0.0868539564734493,0.0861243311433087,0.0855093987604233,0.0849774564142711,0.0831802219872318,0.080262432093808,0.0787284678950094,0.0755079097022074,0.0730147608245953,0.0708743520807467,0.0698815971048883,0.0666734760375409,0.0666356617719093,0.0651987071695471,0.0644150487138076,0.0630227468147279,0.0616263774864147,0.0588378924747827,0.0579853949857011,0.0569876123382445,0.0518146059311177,0.0506799037168261,0.0474592065507767,0.044553724970347,0.0430350564361705,0.0417339282364618,0.0411312810276307,0.0391645403693102,0.038295676714632,0.0378222969939627,0.0369820648261805,0.0361404137009722,0.0333518543666367,0.0322021462777043],[23.2432793593334,54.6975428556174,30.5014845921605,77.3035403138449,361.398276626003,77.442971734526,30.2678340630531,54.5161428599037,56.3755920763972,384.710897933507,425.199572709357,61.2744413579837,375.704466759471,171.42089484351,45.1165184554692,476.164713337261,480.934248801065,36.4790893829854,90.7184719779888,21.2846489926209,23.3567654714363,425.14800135016,46.2098947621026,129.354838486777,35.4749959773666,358.984361856432,19.6938829852883,26.3432762976018,290.218479506771,10.8421587600741,115.954749087692,30.5942311323973,25.8993612553964,221.112971896705,13.7572271844173,378.111629988083,214.943260396062,40.0391557695358,177.002157612315,16.9463197583319,26.4036027679286,9.99042241262381,9.66256205992784,60.503948966961,9.73208597250613,201.137654827083,14.1711242211017,139.387601310275,59.361000550396,12.8991320786959,169.183346590934,10.6677561660065,92.556934201182,20.016003101051,79.6170002102662,16.5749824122734,32.107342670422,15.7685551832418,73.4095100518976,6.43960019422163,9.53388749132565,6.89246690548835,71.5684834785712,85.6768131179772,31.7168365934577,4.67419996248372,76.0517386200891,37.9504396178615,12.9439387295456,39.8647010316367,74.8886812730156,10.6975624554878,10.2056674361908,7.05227003481724]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>segmento<\/th>\n      <th>n<\/th>\n      <th>Apredict<\/th>\n      <th>A_estimate_num<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Pero seguramente, muchos estÃ¡n mÃ¡s acostumbrados a tener un AUC. Podemos tener en cuenta las frecuencias de cada fila usando la librerÃ­a <code>WeightedROC</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(WeightedROC)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># requiere que la etiqueta estÃ© en 1 y 0 </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>rocA <span class="ot">&lt;-</span> WeightedROC<span class="sc">::</span><span class="fu">WeightedROC</span>(test_local<span class="sc">$</span>Apredict,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(test_local<span class="sc">$</span>segmento<span class="sc">==</span> <span class="st">"Best"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weight =</span> test_local<span class="sc">$</span>n)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>WeightedROC<span class="sc">::</span><span class="fu">WeightedAUC</span>(rocA)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.6424796</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y vemos que el AUC teniendo en cuenta los pesos ya no es tan malo (con tan pocas variables tampoco era esperable un auc de 0.83)</p>
<p>Y para el modeloB</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rocB <span class="ot">&lt;-</span> WeightedROC<span class="sc">::</span><span class="fu">WeightedROC</span>(test_local<span class="sc">$</span>Bpredict,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(test_local<span class="sc">$</span>segmento <span class="sc">==</span> <span class="st">"No_way"</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weight =</span> test_local<span class="sc">$</span>n)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>WeightedROC<span class="sc">::</span><span class="fu">WeightedAUC</span>(rocB)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.8495117</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y vemos que para el segmento âNo_wayâ nuestro modelo mixto no estÃ¡ mal del todo.</p>
<p>El prÃ³ximo dÃ­a, quiza lo haga con <code>Stan</code> usando <code>brms</code> que la sintaxis es bastante sencilla.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="joscani/blogComments" data-repo-id="R_kgDOIXA9wA" data-category="General" data-category-id="DIC_kwDOIXA9wM4CSZhs" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","loop":true,"selector":".lightbox","descPosition":"bottom","openEffect":"zoom"});</script>



</body></html>