<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="José Luis Cañadas Reche">
<meta name="dcterms.date" content="2024-06-08">

<title>Muestrear no es pecado - Meta-análisis. Agregando encuestas II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Muestrear no es pecado</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/joscani"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/joscani"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@joscani"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="https://rweekly.org/">
 <span class="dropdown-text">R Weekly</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.r-bloggers.com/">
 <span class="dropdown-text">R Bloggers</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.datanalytics.com/">
 <span class="dropdown-text">Datanalytics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../archive.html"> 
<span class="menu-text">Archivo</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos">Datos</a></li>
  <li><a href="#modelo-meta-análisis" id="toc-modelo-meta-análisis" class="nav-link" data-scroll-target="#modelo-meta-análisis">Modelo meta análisis</a>
  <ul class="collapse">
  <li><a href="#ajuste-con-brms" id="toc-ajuste-con-brms" class="nav-link" data-scroll-target="#ajuste-con-brms">Ajuste con brms</a></li>
  </ul></li>
  <li><a href="#estimación-para-el-día-de-las-elecciones" id="toc-estimación-para-el-día-de-las-elecciones" class="nav-link" data-scroll-target="#estimación-para-el-día-de-las-elecciones">Estimación para el día de las elecciones</a></li>
  <li><a href="#finalizando" id="toc-finalizando" class="nav-link" data-scroll-target="#finalizando">Finalizando</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Meta-análisis. Agregando encuestas II</h1>
  <div class="quarto-categories">
    <div class="quarto-category">2024</div>
    <div class="quarto-category">muestreo</div>
    <div class="quarto-category">encuestas electorales</div>
    <div class="quarto-category">análisis bayesiano</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>José Luis Cañadas Reche </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 8, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Listening
</div>
</div>
<div class="callout-body-container callout-body">
<iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/3RarI3aibhHVM8CgOGE1Ou?utm_source=generator" width="100%" height="250" frameborder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy">
</iframe>
</div>
</div>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>Supongo que se trata de reminiscencias de los tiempos en que curraba en Córdoba, con mi jefe y amigo “el Truji”, pero de vez en cuando me gusta asomarme a las encuestas de estimación de voto.</p>
<p>Ya en algunos post anteriores como en este de <a href="https://muestrear-no-es-pecado.netlify.app/2022/01/01/cocinando/">cocinando</a> contaba de manera simple algunas de las <em>recetas</em> que se usan para la estimación de voto, básicamente contaba temas de post-estratificación utilizando información auxiliar.</p>
<p>Más recientemente en <a href="https://muestrear-no-es-pecado.netlify.app/2023/metanalisis">Meta-análisis. Agregando encuestas</a> hacía un ejercicio de como agregar diferentes encuestas para las elecciones generales de Julio. Y como este finde ando un poco febril por vete tú a saber qué bicho, pues he decidido repetir el ejercicio de meta-análisis para las elecciones europeas de mañana.</p>
<p>Así que se aplica toda la literatura que puse en el post de julio de 2023 y por lo tanto voy a poner más código que otra cosa.</p>
</section>
<section id="datos" class="level2">
<h2 class="anchored" data-anchor-id="datos">Datos</h2>
<p>Los datos que necesito para este ejercicio son simples. A saber.</p>
<ul>
<li>Nombre de la empresa encuestadora: Será un efecto aleatorio</li>
<li>Tamaño de muestra de la encuesta: No todas lo dan</li>
<li>Estimación porcentual a cada partido que dan.</li>
<li>Fecha de publicación de la encuesta: Lo usaré para tener en cuenta la tendencia temporal</li>
</ul>
<p>A partir del n de cada encuesta y de la estimación porcentual a cada partido obtengo grosso modo el número de encuestados que dice que va a votar a cada partido en cada encuesta. Con estos datos ya puedo hacer un modelo multinomial bayesiano que me sirva como agregador de encuestas. Vamos al lío</p>
<p>Los datos los he sacado de la wikipedia, <a href="https://en.wikipedia.org/wiki/Opinion_polling_and_seat_projections_for_the_2024_European_Parliament_election">aqui</a> tal y como amablemente me sugirió Kiko Llaneras.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># no sé pq lo tenia separado por ; y con , como decimal</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span>  <span class="fu">read_csv2</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"2024/06/european_polls_spain.csv"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(empresa, fecha, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lo vemos en forma de tabla html, son unas 31 encuestas</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-987b048b64dc5b56e566" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-987b048b64dc5b56e566">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],["data10","electopanel","sigmados","sociometrica","cluster17","targetpoint","gesop","nc_report","electopanel","sigmados","hamalgama","40db","gad3","cis","metroscopia","celestetel","sociometrica","data10","gad3","nc_report","sigmados","cluster17","sociometrica","nc_report","40db","simplelogica","sigmados","sociometrica","gad3","sigmados","sociometrica"],["2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-30","2024-05-30","2024-05-30","2024-05-29","2024-05-28","2024-05-28","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-23","2024-05-19","2024-05-17","2024-05-13","2024-05-09","2024-04-30","2024-04-12","2024-03-21","2023-12-26","2023-11-24"],["okdiario","electomania","elmundo","elespañol","agendapublica","eldebate","prensa_iberica","la_razon","electomania","elmundo","vozpopuli","prisa","abc","cis","metroscopia","ondacero","elespañol","okdiario","mediaset","la_razon","elmundo","agendapublica","elespañol","la_razon","prisa","eldiario","elmundo","elespañol","abc","elmundo","elespañol"],[1500,1422,3535,630,2060,1003,630,1000,3109,3948,1000,2000,1005,7491,1000,1100,503,1500,1002,1000,2137,1640,519,1000,2000,1131,2120,2550,1017,2992,2109],[30.2,30.2,30.3,29.3,29.5,31,31.5,29.2,30,29.7,29.6,30.1,29.8,32,29.5,29.3,29.4,29.6,31.4,27.9,30.2,28.7,28.8,27.2,30.1,29.9,28.9,26.3,26.5,29.2,29.2],[34.4,32.9,33.2,34.1,33.8,33.5,32,35,33.5,32.7,35.1,33.2,34.9,29.5,33.5,34.9,34.8,35.4,34.5,36.1,35.1,34.1,36.9,36.3,33.5,36.4,35.7,38.1,37.8,38.1,36.8],[1,0.8,0,0.9,0,0,0.9,0,0.8,0.8,0.9,1,0,1,0.8,1,1.4,0.9,0.7,0,0.8,0,0.9,0,1.1,0,0.8,1.7,0.3,0.2,1.1],[3.9,3.6,4.1,3.7,3.5,3.9,4.4,3.6,3.3,4,3.5,4,3.5,3.7,3.6,3.6,3.3,2.9,3,3,3.6,3.4,3.2,2.8,4,2,3.1,2.4,3.5,2.6,2],[10.3,9.5,10.5,10.1,10.3,8.9,8.1,9.9,9.199999999999999,11,10.2,10.7,9.699999999999999,10.1,10.1,9.9,10.7,10.4,9.300000000000001,9,9.699999999999999,9.6,10.4,9.4,12.6,10.9,11.9,10.9,9.199999999999999,11.8,10.2],[4.4,4.2,4.3,3.8,4.5,4.5,5,4.9,4.5,3.8,4.5,4.8,4.8,4,4.7,4.8,4.5,4.7,4.5,5.2,3.6,4.5,5.1,4.9,4.6,4.8,4.1,6.1,4.4,2.8,4.2],[2.5,2.5,1.9,2.8,2.6,2.4,2,2.8,2.5,1.9,2.5,2.1,2.4,1.6,2.3,2.6,2.7,2.5,2.4,2.9,2.4,2.6,2.4,2.7,2.2,2.2,2,2.6,2.7,2.3,5.1],[1.6,1.7,1.4,1.6,1.7,0,1.8,1.9,2,1.3,0,1.4,1.9,1.2,1.8,1.8,1.4,1.7,1.5,2.2,1.3,1.9,1.3,2.1,1.9,1.1,1.8,1.8,2.4,2,1.3],[0,1.2,0,0,0,0,0,0,1.3,0,0,0,0,0,0,1.1,0,0,0,0,0,1.3,0,0,0,0,0,0,0,0,0],[6.2,5.9,6,6.3,5.9,6,5.8,6.4,6.3,6.9,6.3,5.6,5.9,6,5.9,6.3,6.3,6.4,5.7,6.8,7,6.7,7,7.7,5.7,8,9.5,6.7,7.2,10.1,8],[0,2.5,3.4,2.7,2.3,2.9,3.7,2.2,2,3.5,2,2.5,2.4,5.2,3.1,1.9,2,0,2.7,1.2,2.6,2.2,0.8,1.4,0,0,0,0,0,0,0],[94.5,95,95.09999999999999,95.3,94.09999999999999,93.09999999999999,95.2,95.90000000000001,95.40000000000001,95.59999999999999,94.59999999999999,95.40000000000001,95.3,94.3,95.3,97.2,96.5,94.5,95.7,94.3,96.3,95,96.8,94.5,95.7,95.3,97.8,96.59999999999999,94,99.09999999999999,97.90000000000001],[5.5,5,4.89999999999999,4.7,5.90000000000001,6.90000000000001,4.8,4.09999999999999,4.59999999999999,4.39999999999999,5.39999999999999,4.59999999999999,4.7,5.7,4.7,2.8,3.5,5.5,4.3,5.7,3.7,5,3.2,5.5,4.3,4.7,2.2,3.39999999999999,6,0.900000000000006,2.10000000000001]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>empresa<\/th>\n      <th>fecha<\/th>\n      <th>medio<\/th>\n      <th>n<\/th>\n      <th>psoe<\/th>\n      <th>pp<\/th>\n      <th>ciudadanos<\/th>\n      <th>podemos<\/th>\n      <th>vox<\/th>\n      <th>ar<\/th>\n      <th>junts<\/th>\n      <th>europa_solidaria<\/th>\n      <th>pacma<\/th>\n      <th>sumar<\/th>\n      <th>salf<\/th>\n      <th>Tot_pct<\/th>\n      <th>resto<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"empresa","targets":1},{"name":"fecha","targets":2},{"name":"medio","targets":3},{"name":"n","targets":4},{"name":"psoe","targets":5},{"name":"pp","targets":6},{"name":"ciudadanos","targets":7},{"name":"podemos","targets":8},{"name":"vox","targets":9},{"name":"ar","targets":10},{"name":"junts","targets":11},{"name":"europa_solidaria","targets":12},{"name":"pacma","targets":13},{"name":"sumar","targets":14},{"name":"salf","targets":15},{"name":"Tot_pct","targets":16},{"name":"resto","targets":17}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Para quien no lo sepa hay algunas coaliciones curiosas. * AR: Ahora república. Están ERC y el BNG por ejemplo * Europa Solidaria: Dónde está el pnv * Salf: Se acabó la fiesta, el partido de Alvise que las encuestas más recientes lo están teniendo en cuenta</p>
<p>Vamos a tratar un poco los datos.</p>
<p>Al pacma lo voy a meter junto con “resto”. Este es mi blog y aquí no impera la democracia, se siente.</p>
<p>También calculo una columna <code>time</code> que indica los días que faltaban para las elecciones desde la fecha de publicación.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">resto =</span> resto <span class="sc">+</span> pacma) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pacma, <span class="sc">-</span> Tot_pct) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(psoe, pp, ciudadanos, podemos, vox, ar, junts, europa_solidaria, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                 sumar, salf, resto)) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">votos =</span> n <span class="sc">*</span> value <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">partido =</span> name, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">estim =</span> value) <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> fecha <span class="sc">-</span> <span class="fu">ymd</span>(<span class="st">"2024-06-09"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        ) </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-15a5ae9b9e28fd11e4bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-15a5ae9b9e28fd11e4bd">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341"],["data10","data10","data10","data10","data10","data10","data10","data10","data10","data10","data10","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","targetpoint","gesop","gesop","gesop","gesop","gesop","gesop","gesop","gesop","gesop","gesop","gesop","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","electopanel","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","hamalgama","40db","40db","40db","40db","40db","40db","40db","40db","40db","40db","40db","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","cis","cis","cis","cis","cis","cis","cis","cis","cis","cis","cis","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","celestetel","celestetel","celestetel","celestetel","celestetel","celestetel","celestetel","celestetel","celestetel","celestetel","celestetel","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","data10","data10","data10","data10","data10","data10","data10","data10","data10","data10","data10","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","cluster17","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","nc_report","40db","40db","40db","40db","40db","40db","40db","40db","40db","40db","40db","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","simplelogica","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","gad3","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sigmados","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica","sociometrica"],["2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-06-03","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-31","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-30","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-29","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-28","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-24","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-23","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-19","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-17","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-13","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-05-09","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-30","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-04-12","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2024-03-21","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-12-26","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24","2023-11-24"],["okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","eldebate","eldebate","eldebate","eldebate","eldebate","eldebate","eldebate","eldebate","eldebate","eldebate","eldebate","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","prensa_iberica","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","electomania","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","vozpopuli","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","abc","abc","abc","abc","abc","abc","abc","abc","abc","abc","abc","cis","cis","cis","cis","cis","cis","cis","cis","cis","cis","cis","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","metroscopia","ondacero","ondacero","ondacero","ondacero","ondacero","ondacero","ondacero","ondacero","ondacero","ondacero","ondacero","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","okdiario","mediaset","mediaset","mediaset","mediaset","mediaset","mediaset","mediaset","mediaset","mediaset","mediaset","mediaset","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","agendapublica","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","la_razon","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","prisa","eldiario","eldiario","eldiario","eldiario","eldiario","eldiario","eldiario","eldiario","eldiario","eldiario","eldiario","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","abc","abc","abc","abc","abc","abc","abc","abc","abc","abc","abc","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elmundo","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol","elespañol"],[1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1422,1422,1422,1422,1422,1422,1422,1422,1422,1422,1422,3535,3535,3535,3535,3535,3535,3535,3535,3535,3535,3535,630,630,630,630,630,630,630,630,630,630,630,2060,2060,2060,2060,2060,2060,2060,2060,2060,2060,2060,1003,1003,1003,1003,1003,1003,1003,1003,1003,1003,1003,630,630,630,630,630,630,630,630,630,630,630,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,3109,3109,3109,3109,3109,3109,3109,3109,3109,3109,3109,3948,3948,3948,3948,3948,3948,3948,3948,3948,3948,3948,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,1005,1005,1005,1005,1005,1005,1005,1005,1005,1005,1005,7491,7491,7491,7491,7491,7491,7491,7491,7491,7491,7491,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1100,1100,1100,1100,1100,1100,1100,1100,1100,1100,1100,503,503,503,503,503,503,503,503,503,503,503,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1500,1002,1002,1002,1002,1002,1002,1002,1002,1002,1002,1002,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,2137,2137,2137,2137,2137,2137,2137,2137,2137,2137,2137,1640,1640,1640,1640,1640,1640,1640,1640,1640,1640,1640,519,519,519,519,519,519,519,519,519,519,519,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,1000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,2000,1131,1131,1131,1131,1131,1131,1131,1131,1131,1131,1131,2120,2120,2120,2120,2120,2120,2120,2120,2120,2120,2120,2550,2550,2550,2550,2550,2550,2550,2550,2550,2550,2550,1017,1017,1017,1017,1017,1017,1017,1017,1017,1017,1017,2992,2992,2992,2992,2992,2992,2992,2992,2992,2992,2992,2109,2109,2109,2109,2109,2109,2109,2109,2109,2109,2109],["psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto","psoe","pp","ciudadanos","podemos","vox","ar","junts","europa_solidaria","sumar","salf","resto"],[30.2,34.4,1,3.9,10.3,4.4,2.5,1.6,6.2,0,5.5,30.2,32.9,0.8,3.6,9.5,4.2,2.5,1.7,5.9,2.5,6.2,30.3,33.2,0,4.1,10.5,4.3,1.9,1.4,6,3.4,4.89999999999999,29.3,34.1,0.9,3.7,10.1,3.8,2.8,1.6,6.3,2.7,4.7,29.5,33.8,0,3.5,10.3,4.5,2.6,1.7,5.9,2.3,5.90000000000001,31,33.5,0,3.9,8.9,4.5,2.4,0,6,2.9,6.90000000000001,31.5,32,0.9,4.4,8.1,5,2,1.8,5.8,3.7,4.8,29.2,35,0,3.6,9.9,4.9,2.8,1.9,6.4,2.2,4.09999999999999,30,33.5,0.8,3.3,9.199999999999999,4.5,2.5,2,6.3,2,5.89999999999999,29.7,32.7,0.8,4,11,3.8,1.9,1.3,6.9,3.5,4.39999999999999,29.6,35.1,0.9,3.5,10.2,4.5,2.5,0,6.3,2,5.39999999999999,30.1,33.2,1,4,10.7,4.8,2.1,1.4,5.6,2.5,4.59999999999999,29.8,34.9,0,3.5,9.699999999999999,4.8,2.4,1.9,5.9,2.4,4.7,32,29.5,1,3.7,10.1,4,1.6,1.2,6,5.2,5.7,29.5,33.5,0.8,3.6,10.1,4.7,2.3,1.8,5.9,3.1,4.7,29.3,34.9,1,3.6,9.9,4.8,2.6,1.8,6.3,1.9,3.9,29.4,34.8,1.4,3.3,10.7,4.5,2.7,1.4,6.3,2,3.5,29.6,35.4,0.9,2.9,10.4,4.7,2.5,1.7,6.4,0,5.5,31.4,34.5,0.7,3,9.300000000000001,4.5,2.4,1.5,5.7,2.7,4.3,27.9,36.1,0,3,9,5.2,2.9,2.2,6.8,1.2,5.7,30.2,35.1,0.8,3.6,9.699999999999999,3.6,2.4,1.3,7,2.6,3.7,28.7,34.1,0,3.4,9.6,4.5,2.6,1.9,6.7,2.2,6.3,28.8,36.9,0.9,3.2,10.4,5.1,2.4,1.3,7,0.8,3.2,27.2,36.3,0,2.8,9.4,4.9,2.7,2.1,7.7,1.4,5.5,30.1,33.5,1.1,4,12.6,4.6,2.2,1.9,5.7,0,4.3,29.9,36.4,0,2,10.9,4.8,2.2,1.1,8,0,4.7,28.9,35.7,0.8,3.1,11.9,4.1,2,1.8,9.5,0,2.2,26.3,38.1,1.7,2.4,10.9,6.1,2.6,1.8,6.7,0,3.39999999999999,26.5,37.8,0.3,3.5,9.199999999999999,4.4,2.7,2.4,7.2,0,6,29.2,38.1,0.2,2.6,11.8,2.8,2.3,2,10.1,0,0.900000000000006,29.2,36.8,1.1,2,10.2,4.2,5.1,1.3,8,0,2.10000000000001],[453,516,15,58.5,154.5,66.00000000000001,37.5,24,93,0,82.5,429.444,467.838,11.376,51.192,135.09,59.724,35.55,24.174,83.89800000000001,35.55,88.164,1071.105,1173.62,0,144.935,371.175,152.005,67.16500000000001,49.49,212.1,120.19,173.2149999999996,184.59,214.83,5.67,23.31,63.63,23.94,17.64,10.08,39.69,17.01,29.61,607.7,696.28,0,72.09999999999999,212.18,92.7,53.56,35.02,121.54,47.38,121.5400000000002,310.93,336.005,0,39.117,89.26700000000001,45.135,24.072,0,60.18,29.087,69.20700000000009,198.45,201.6,5.67,27.72,51.03,31.5,12.6,11.34,36.54,23.31,30.24,292,350,0,36,99,49,28,19,64,22,40.9999999999999,932.7,1041.515,24.872,102.597,286.028,139.905,77.72499999999999,62.18,195.867,62.18,183.4309999999997,1172.556,1290.996,31.584,157.92,434.28,150.024,75.012,51.32400000000001,272.412,138.18,173.7119999999996,296,351,9,35,102,45,25,0,63,20,53.9999999999999,602,664,20,80,214,96,42,28,112,50,91.9999999999998,299.49,350.745,0,35.175,97.485,48.24,24.12,19.095,59.295,24.12,47.235,2397.12,2209.845,74.91,277.167,756.5909999999999,299.64,119.856,89.892,449.46,389.532,426.987,295,335,8,36,101,47,23,18,59,31,47,322.3,383.9,11,39.6,108.9,52.8,28.6,19.8,69.3,20.9,42.9,147.882,175.044,7.041999999999999,16.599,53.821,22.635,13.581,7.041999999999999,31.689,10.06,17.605,444,531,13.5,43.5,156,70.5,37.5,25.5,96,0,82.5,314.628,345.69,7.013999999999999,30.06,93.18600000000001,45.09,24.048,15.03,57.114,27.054,43.08599999999999,279,361,0,30,90,52,29,22,68,12,57,645.374,750.087,17.096,76.932,207.289,76.932,51.288,27.781,149.59,55.562,79.069,470.68,559.24,0,55.76,157.44,73.8,42.64,31.16,109.88,36.08000000000001,103.32,149.472,191.511,4.671,16.608,53.97600000000001,26.469,12.456,6.747000000000001,36.33,4.152,16.608,272,363,0,28,94,49,27,21,77,14,55,602,670,22,80,252,92,44,38,114,0,86,338.169,411.684,0,22.62,123.279,54.288,24.882,12.441,90.48,0,53.157,612.6799999999999,756.84,16.96,65.72,252.28,86.92,42.4,38.16,201.4,0,46.64,670.65,971.55,43.35,61.2,277.95,155.55,66.3,45.9,170.85,0,86.69999999999975,269.505,384.426,3.051,35.595,93.56399999999999,44.748,27.459,24.408,73.224,0,61.02,873.664,1139.952,5.984,77.792,353.056,83.77600000000001,68.81599999999999,59.84,302.192,0,26.92800000000018,615.828,776.112,23.199,42.18,215.118,88.57800000000002,107.559,27.417,168.72,0,44.28900000000021],[-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-6,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-10,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-11,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-16,-17,-17,-17,-17,-17,-17,-17,-17,-17,-17,-17,-21,-21,-21,-21,-21,-21,-21,-21,-21,-21,-21,-23,-23,-23,-23,-23,-23,-23,-23,-23,-23,-23,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-31,-31,-31,-31,-31,-31,-31,-31,-31,-31,-31,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-58,-58,-58,-58,-58,-58,-58,-58,-58,-58,-58,-80,-80,-80,-80,-80,-80,-80,-80,-80,-80,-80,-166,-166,-166,-166,-166,-166,-166,-166,-166,-166,-166,-198,-198,-198,-198,-198,-198,-198,-198,-198,-198,-198]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>empresa<\/th>\n      <th>fecha<\/th>\n      <th>medio<\/th>\n      <th>n<\/th>\n      <th>partido<\/th>\n      <th>estim<\/th>\n      <th>votos<\/th>\n      <th>time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"empresa","targets":1},{"name":"fecha","targets":2},{"name":"medio","targets":3},{"name":"n","targets":4},{"name":"partido","targets":5},{"name":"estim","targets":6},{"name":"votos","targets":7},{"name":"time","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Podemos pintar algo, dónde se ve que la distancia entre PSOE y PP ha disminuido conforme se acercaba el día 9</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>colores <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"psoe"</span> <span class="ot">=</span> <span class="st">"#FF0126"</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pp"</span> <span class="ot">=</span> <span class="st">"#005999"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ciudadanos"</span> <span class="ot">=</span> <span class="st">"#FF5824"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"podemos"</span> <span class="ot">=</span> <span class="st">"#8C66F1"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"vox"</span> <span class="ot">=</span> <span class="st">"#51962A"</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ar"</span> <span class="ot">=</span> <span class="st">"#A06464"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"junts"</span> <span class="ot">=</span> <span class="st">"#00C3B2"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"europa_solidaria"</span> <span class="ot">=</span> <span class="st">"#00309A"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sumar"</span> <span class="ot">=</span> <span class="st">"#E51C55"</span>, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"salf"</span> <span class="ot">=</span> <span class="st">"#ECC29E"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"resto"</span> <span class="ot">=</span> <span class="st">"grey"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>df_new <span class="sc">|&gt;</span> </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> estim,<span class="at">color =</span> partido )) <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colores) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="meta-analisis-europeas_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Para hacer el modelo multinomial necesito que la columna votos tenga valores enteros y que el n sea la suma, así que voy a pivotar y poner todo en orden</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df_wider <span class="ot">&lt;-</span> df_new <span class="sc">|&gt;</span>  </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>estim) <span class="sc">|&gt;</span>  </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>( <span class="at">id_cols =</span> <span class="fu">c</span>(empresa, n, time),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_from =</span> partido, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_from =</span> votos) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(psoe, pp, ciudadanos,podemos,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                  vox, ar, junts, europa_solidaria,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                  sumar, salf, resto), round)) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> psoe <span class="sc">+</span> pp <span class="sc">+</span> ciudadanos <span class="sc">+</span> podemos <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>      vox <span class="sc">+</span> ar <span class="sc">+</span> junts <span class="sc">+</span> europa_solidaria <span class="sc">+</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      sumar <span class="sc">+</span> salf <span class="sc">+</span> resto</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df_wider)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7825bc6f436ca08fa292" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7825bc6f436ca08fa292">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],["data10","electopanel","sigmados","sociometrica","cluster17","targetpoint","gesop","nc_report","electopanel","sigmados","hamalgama","40db","gad3","cis","metroscopia","celestetel","sociometrica","data10","gad3","nc_report","sigmados","cluster17","sociometrica","nc_report","40db","simplelogica","sigmados","sociometrica","gad3","sigmados","sociometrica"],[1500,1422,3534,632,2061,1002,631,1000,3110,3948,1000,2000,1003,7492,1000,1101,505,1501,1002,1000,2137,1640,519,1000,2000,1130,2120,2551,1017,2993,2109],[-6,-6,-6,-6,-9,-9,-9,-9,-9,-9,-9,-10,-10,-10,-11,-12,-12,-16,-16,-16,-16,-17,-21,-23,-27,-31,-40,-58,-80,-166,-198],[453,429,1071,185,608,311,198,292,933,1173,296,602,299,2397,295,322,148,444,315,279,645,471,149,272,602,338,613,671,270,874,616],[516,468,1174,215,696,336,202,350,1042,1291,351,664,351,2210,335,384,175,531,346,361,750,559,192,363,670,412,757,972,384,1140,776],[15,11,0,6,0,0,6,0,25,32,9,20,0,75,8,11,7,14,7,0,17,0,5,0,22,0,17,43,3,6,23],[58,51,145,23,72,39,28,36,103,158,35,80,35,277,36,40,17,44,30,30,77,56,17,28,80,23,66,61,36,78,42],[155,135,371,64,212,89,51,99,286,434,102,214,97,757,101,109,54,156,93,90,207,157,54,94,252,123,252,278,94,353,215],[66,60,152,24,93,45,32,49,140,150,45,96,48,300,47,53,23,70,45,52,77,74,26,49,92,54,87,156,45,84,89],[38,36,67,18,54,24,13,28,78,75,25,42,24,120,23,29,14,38,24,29,51,43,12,27,44,25,42,66,27,69,108],[24,24,49,10,35,0,11,19,62,51,0,28,19,90,18,20,7,26,15,22,28,31,7,21,38,12,38,46,24,60,27],[93,84,212,40,122,60,37,64,196,272,63,112,59,449,59,69,32,96,57,68,150,110,36,77,114,90,201,171,73,302,169],[0,36,120,17,47,29,23,22,62,138,20,50,24,390,31,21,10,0,27,12,56,36,4,14,0,0,0,0,0,0,0],[82,88,173,30,122,69,30,41,183,174,54,92,47,427,47,43,18,82,43,57,79,103,17,55,86,53,47,87,61,27,44]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>empresa<\/th>\n      <th>n<\/th>\n      <th>time<\/th>\n      <th>psoe<\/th>\n      <th>pp<\/th>\n      <th>ciudadanos<\/th>\n      <th>podemos<\/th>\n      <th>vox<\/th>\n      <th>ar<\/th>\n      <th>junts<\/th>\n      <th>europa_solidaria<\/th>\n      <th>sumar<\/th>\n      <th>salf<\/th>\n      <th>resto<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,4,5,6,7,8,9,10,11,12,13,14]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"empresa","targets":1},{"name":"n","targets":2},{"name":"time","targets":3},{"name":"psoe","targets":4},{"name":"pp","targets":5},{"name":"ciudadanos","targets":6},{"name":"podemos","targets":7},{"name":"vox","targets":8},{"name":"ar","targets":9},{"name":"junts","targets":10},{"name":"europa_solidaria","targets":11},{"name":"sumar","targets":12},{"name":"salf","targets":13},{"name":"resto","targets":14}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>El modelo lo voy a ajustar usando <code>brms</code> y necesito tener una columna que sea la concatenación de los diferentes votos a cada partido.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_wider<span class="sc">$</span>cell_counts <span class="ot">&lt;-</span> <span class="fu">with</span>(df_wider, <span class="fu">cbind</span>(psoe, pp, ciudadanos,podemos,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                             vox, ar, junts, europa_solidaria,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                             sumar, salf, resto))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(df_wider <span class="sc">|&gt;</span> <span class="fu">select</span>(empresa, time, n, cell_counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-1ddbd3bd806b8d0e4585" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1ddbd3bd806b8d0e4585">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"],["data10","electopanel","sigmados","sociometrica","cluster17","targetpoint","gesop","nc_report","electopanel","sigmados","hamalgama","40db","gad3","cis","metroscopia","celestetel","sociometrica","data10","gad3","nc_report","sigmados","cluster17","sociometrica","nc_report","40db","simplelogica","sigmados","sociometrica","gad3","sigmados","sociometrica"],[-6,-6,-6,-6,-9,-9,-9,-9,-9,-9,-9,-10,-10,-10,-11,-12,-12,-16,-16,-16,-16,-17,-21,-23,-27,-31,-40,-58,-80,-166,-198],[1500,1422,3534,632,2061,1002,631,1000,3110,3948,1000,2000,1003,7492,1000,1101,505,1501,1002,1000,2137,1640,519,1000,2000,1130,2120,2551,1017,2993,2109],[[453,516,15,58,155,66,38,24,93,0,82],[429,468,11,51,135,60,36,24,84,36,88],[1071,1174,0,145,371,152,67,49,212,120,173],[185,215,6,23,64,24,18,10,40,17,30],[608,696,0,72,212,93,54,35,122,47,122],[311,336,0,39,89,45,24,0,60,29,69],[198,202,6,28,51,32,13,11,37,23,30],[292,350,0,36,99,49,28,19,64,22,41],[933,1042,25,103,286,140,78,62,196,62,183],[1173,1291,32,158,434,150,75,51,272,138,174],[296,351,9,35,102,45,25,0,63,20,54],[602,664,20,80,214,96,42,28,112,50,92],[299,351,0,35,97,48,24,19,59,24,47],[2397,2210,75,277,757,300,120,90,449,390,427],[295,335,8,36,101,47,23,18,59,31,47],[322,384,11,40,109,53,29,20,69,21,43],[148,175,7,17,54,23,14,7,32,10,18],[444,531,14,44,156,70,38,26,96,0,82],[315,346,7,30,93,45,24,15,57,27,43],[279,361,0,30,90,52,29,22,68,12,57],[645,750,17,77,207,77,51,28,150,56,79],[471,559,0,56,157,74,43,31,110,36,103],[149,192,5,17,54,26,12,7,36,4,17],[272,363,0,28,94,49,27,21,77,14,55],[602,670,22,80,252,92,44,38,114,0,86],[338,412,0,23,123,54,25,12,90,0,53],[613,757,17,66,252,87,42,38,201,0,47],[671,972,43,61,278,156,66,46,171,0,87],[270,384,3,36,94,45,27,24,73,0,61],[874,1140,6,78,353,84,69,60,302,0,27],[616,776,23,42,215,89,108,27,169,0,44]]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>empresa<\/th>\n      <th>time<\/th>\n      <th>n<\/th>\n      <th>cell_counts<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"empresa","targets":1},{"name":"time","targets":2},{"name":"n","targets":3},{"name":"cell_counts","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Y con esto ya puedo</p>
</section>
<section id="modelo-meta-análisis" class="level2">
<h2 class="anchored" data-anchor-id="modelo-meta-análisis">Modelo meta análisis</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.backend=</span><span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>En la especificación del modelo pongo la empresa como efecto aleatorio y añado también un término general que recoja la tendencia temporal global y por empresa encuestadora.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> <span class="fu">brmsformula</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    cell_counts <span class="sc">|</span> <span class="fu">trials</span>(n) <span class="sc">~</span>  (time <span class="sc">|</span>empresa) <span class="sc">+</span> time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Vemos las priors por defecto que usa brms. Lo suyo sería estudiar con cuidado todo este tema para elegir unas priors informativas si se pudiera.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vemos las priors por defecto qeu h</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>(priors <span class="ot">&lt;-</span> <span class="fu">get_prior</span>(formula, df_wider, <span class="at">family =</span> <span class="fu">multinomial</span>()))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 prior     class      coef   group resp              dpar nlpar</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                lkj(1)       cor                                               </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                lkj(1)       cor           empresa                             </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                     muar      </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                           muar      </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                     muar      </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                     muar      </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                   muar      </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                   muar      </span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                   muar      </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                             muciudadanos      </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                   muciudadanos      </span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                             muciudadanos      </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                             muciudadanos      </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa           muciudadanos      </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa           muciudadanos      </span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa           muciudadanos      </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                        mueuropasolidaria      </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time              mueuropasolidaria      </span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                        mueuropasolidaria      </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                        mueuropasolidaria      </span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa      mueuropasolidaria      </span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa      mueuropasolidaria      </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa      mueuropasolidaria      </span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                  mujunts      </span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                        mujunts      </span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                  mujunts      </span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                  mujunts      </span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                mujunts      </span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                mujunts      </span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                mujunts      </span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                mupodemos      </span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                      mupodemos      </span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                mupodemos      </span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                mupodemos      </span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa              mupodemos      </span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa              mupodemos      </span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa              mupodemos      </span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                     mupp      </span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                           mupp      </span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                     mupp      </span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                     mupp      </span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                   mupp      </span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                   mupp      </span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                   mupp      </span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                  muresto      </span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                        muresto      </span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                  muresto      </span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                  muresto      </span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                muresto      </span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                muresto      </span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                muresto      </span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                   musalf      </span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                         musalf      </span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                   musalf      </span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                   musalf      </span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                 musalf      </span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                 musalf      </span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                 musalf      </span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                  musumar      </span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                        musumar      </span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                  musumar      </span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                  musumar      </span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                musumar      </span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                musumar      </span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                musumar      </span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b                                    muvox      </span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                (flat)         b      time                          muvox      </span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5) Intercept                                    muvox      </span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd                                    muvox      </span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd           empresa                  muvox      </span></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd Intercept empresa                  muvox      </span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  student_t(3, 0, 2.5)        sd      time empresa                  muvox      </span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  lb ub       source</span></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        (vectorized)</span></span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             default</span></span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0         default</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0    (vectorized)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="ajuste-con-brms" class="level3">
<h3 class="anchored" data-anchor-id="ajuste-con-brms">Ajuste con brms</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>model_multinomial <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">brm</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        formula,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        df_wider,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">multinomial</span>(),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">prior =</span> priors,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">file =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"2024/06/mod_meta_europeas"</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_multinomial)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: multinomial </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Links: mupp = logit; muciudadanos = logit; mupodemos = logit; muvox = logit; muar = logit; mujunts = logit; mueuropasolidaria = logit; musumar = logit; musalf = logit; muresto = logit </span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: cell_counts | trials(n) ~ (time | empresa) + time </span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: df_wider (Number of observations: 31) </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          total post-warmup draws = 6000</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multilevel Hyperparameters:</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ~empresa (Number of levels: 15) </span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                         Estimate Est.Error</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupp_Intercept)                                          0.08      0.02</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupp_time)                                               0.00      0.00</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muciudadanos_Intercept)                                  1.73      0.58</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muciudadanos_time)                                       0.01      0.01</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupodemos_Intercept)                                     0.05      0.04</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupodemos_time)                                          0.00      0.00</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muvox_Intercept)                                         0.05      0.03</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muvox_time)                                              0.00      0.00</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muar_Intercept)                                          0.09      0.04</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muar_time)                                               0.00      0.00</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mujunts_Intercept)                                       0.15      0.06</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mujunts_time)                                            0.00      0.00</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mueuropasolidaria_Intercept)                             0.80      0.31</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mueuropasolidaria_time)                                  0.01      0.01</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musumar_Intercept)                                       0.06      0.04</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musumar_time)                                            0.00      0.00</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musalf_Intercept)                                        1.31      0.51</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musalf_time)                                             0.10      0.04</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muresto_Intercept)                                       0.10      0.07</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muresto_time)                                            0.01      0.00</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mupp_Intercept,mupp_time)                               0.29      0.52</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muciudadanos_Intercept,muciudadanos_time)              -0.23      0.58</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mupodemos_Intercept,mupodemos_time)                     0.10      0.58</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muvox_Intercept,muvox_time)                             0.05      0.59</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muar_Intercept,muar_time)                              -0.17      0.51</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mujunts_Intercept,mujunts_time)                        -0.13      0.56</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mueuropasolidaria_Intercept,mueuropasolidaria_time)     0.19      0.63</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(musumar_Intercept,musumar_time)                        -0.03      0.56</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(musalf_Intercept,musalf_time)                           0.37      0.38</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muresto_Intercept,muresto_time)                        -0.11      0.51</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                         l-95% CI u-95% CI Rhat</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupp_Intercept)                                          0.04     0.13 1.00</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupp_time)                                               0.00     0.00 1.00</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muciudadanos_Intercept)                                  0.84     3.13 1.00</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muciudadanos_time)                                       0.00     0.05 1.00</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupodemos_Intercept)                                     0.00     0.15 1.00</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupodemos_time)                                          0.00     0.01 1.00</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muvox_Intercept)                                         0.00     0.12 1.00</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muvox_time)                                              0.00     0.01 1.00</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muar_Intercept)                                          0.01     0.19 1.00</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muar_time)                                               0.00     0.01 1.00</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mujunts_Intercept)                                       0.03     0.30 1.00</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mujunts_time)                                            0.00     0.01 1.00</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mueuropasolidaria_Intercept)                             0.35     1.52 1.00</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mueuropasolidaria_time)                                  0.00     0.03 1.00</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musumar_Intercept)                                       0.00     0.14 1.00</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musumar_time)                                            0.00     0.01 1.00</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musalf_Intercept)                                        0.53     2.52 1.00</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musalf_time)                                             0.04     0.20 1.00</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muresto_Intercept)                                       0.01     0.25 1.00</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muresto_time)                                            0.00     0.02 1.00</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mupp_Intercept,mupp_time)                              -0.80     0.97 1.00</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muciudadanos_Intercept,muciudadanos_time)              -0.98     0.91 1.00</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mupodemos_Intercept,mupodemos_time)                    -0.93     0.96 1.00</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muvox_Intercept,muvox_time)                            -0.95     0.96 1.00</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muar_Intercept,muar_time)                              -0.96     0.79 1.00</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mujunts_Intercept,mujunts_time)                        -0.97     0.88 1.00</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mueuropasolidaria_Intercept,mueuropasolidaria_time)    -0.94     0.99 1.00</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(musumar_Intercept,musumar_time)                        -0.96     0.92 1.00</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(musalf_Intercept,musalf_time)                          -0.49     0.91 1.00</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muresto_Intercept,muresto_time)                        -0.95     0.83 1.00</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                                                         Bulk_ESS Tail_ESS</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupp_Intercept)                                          3195     4001</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupp_time)                                               2226     2389</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muciudadanos_Intercept)                                  1196      782</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muciudadanos_time)                                       1253      687</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupodemos_Intercept)                                     3080     3141</span></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mupodemos_time)                                          1411     2934</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muvox_Intercept)                                         2362     3231</span></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muvox_time)                                              1754     3067</span></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muar_Intercept)                                          2195     1342</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muar_time)                                               1948     3040</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mujunts_Intercept)                                       1707     1039</span></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mujunts_time)                                            1687     1254</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mueuropasolidaria_Intercept)                             1493     2842</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(mueuropasolidaria_time)                                  1964     2282</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musumar_Intercept)                                       2149      895</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musumar_time)                                            1765     2996</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musalf_Intercept)                                        1587     1236</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(musalf_time)                                             1398     1922</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muresto_Intercept)                                       2011     2922</span></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sd(muresto_time)                                            2145     3064</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mupp_Intercept,mupp_time)                               5781     4411</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muciudadanos_Intercept,muciudadanos_time)               6101     4338</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mupodemos_Intercept,mupodemos_time)                     3000     3892</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muvox_Intercept,muvox_time)                             4119     3862</span></span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muar_Intercept,muar_time)                               4117     4341</span></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mujunts_Intercept,mujunts_time)                         3736     3839</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(mueuropasolidaria_Intercept,mueuropasolidaria_time)     3570     3560</span></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(musumar_Intercept,musumar_time)                         3785     3838</span></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(musalf_Intercept,musalf_time)                           2478     3113</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cor(muresto_Intercept,muresto_time)                         1655     2268</span></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Regression Coefficients:</span></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupp_Intercept                  0.12      0.03     0.06     0.17 1.00     4247</span></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muciudadanos_Intercept         -4.35      0.51    -5.46    -3.44 1.00     1660</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupodemos_Intercept            -2.09      0.04    -2.18    -2.01 1.00     4929</span></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muvox_Intercept                -1.09      0.03    -1.15    -1.04 1.00     6204</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muar_Intercept                 -1.87      0.04    -1.95    -1.78 1.00     4436</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mujunts_Intercept              -2.60      0.06    -2.72    -2.47 1.00     5477</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mueuropasolidaria_Intercept    -3.20      0.24    -3.73    -2.76 1.00     1818</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musumar_Intercept              -1.58      0.04    -1.66    -1.52 1.00     5585</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musalf_Intercept               -1.82      0.46    -2.74    -0.90 1.00     2711</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muresto_Intercept              -1.78      0.06    -1.90    -1.65 1.00     3720</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupp_time                      -0.00      0.00    -0.00     0.00 1.00     4669</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muciudadanos_time               0.00      0.01    -0.01     0.02 1.00     2370</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupodemos_time                  0.00      0.00    -0.00     0.01 1.00     3425</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muvox_time                     -0.00      0.00    -0.00     0.00 1.00     3952</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muar_time                       0.00      0.00    -0.00     0.00 1.00     4523</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mujunts_time                   -0.00      0.00    -0.01     0.00 1.00     4341</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mueuropasolidaria_time         -0.00      0.01    -0.02     0.00 1.00     2307</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musumar_time                   -0.00      0.00    -0.01     0.00 1.00     4455</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musalf_time                     0.09      0.04     0.01     0.16 1.00     1641</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muresto_time                   -0.00      0.00    -0.01     0.01 1.00     2554</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                             Tail_ESS</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupp_Intercept                  4114</span></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muciudadanos_Intercept          2252</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupodemos_Intercept             4637</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muvox_Intercept                 4966</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muar_Intercept                  3290</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mujunts_Intercept               5073</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mueuropasolidaria_Intercept     2660</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musumar_Intercept               4243</span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musalf_Intercept                3752</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muresto_Intercept               4273</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupp_time                       3415</span></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muciudadanos_time               1550</span></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mupodemos_time                  2887</span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muvox_time                      3376</span></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muar_time                       3352</span></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mujunts_time                    2454</span></span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mueuropasolidaria_time          2064</span></span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musumar_time                    3421</span></span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; musalf_time                     1854</span></span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; muresto_time                    2462</span></span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="estimación-para-el-día-de-las-elecciones" class="level2">
<h2 class="anchored" data-anchor-id="estimación-para-el-día-de-las-elecciones">Estimación para el día de las elecciones</h2>
<p>Ante todo mucha calma, como diría Siniestro Total. La info que tenemos sólo tiene en cuenta lo publicado por las empresas, no sabemos nada de cómo lo han cocinado cada una y tampoco de la muestra efectiva. Esto es sólo un ejercicio para mi propia diversión personal.</p>
<p>¿Cómo obtendríamos la predicción para el día de las elecciones? El modelo multinomial devuelve el número de votos a repartir dado un <em>n</em> , si considro n = 1 me devuelve las proporciones estimadas. Lo que voy a hacer es considerar que las elecciones es “una nueva encuesta” con <code>n = 1</code> y con <code>time = 0</code> y que tenemos un nuevo nivel en la empresa encuestadora.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">empresa =</span> <span class="st">"votaciones_dia_9"</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="dv">0</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span> <span class="dv">1</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>newdata</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   empresa           time     n</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 votaciones_dia_9     0     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>estimaciones <span class="ot">&lt;-</span>  newdata <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_epred_draws</span>(model_multinomial, <span class="at">allow_new_levels =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">partido =</span> <span class="fu">as_factor</span>(.category)) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>.category)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(estimaciones )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 66000    10</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="fu">head</span>(estimaciones, <span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-19914607c967c4413137" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-19914607c967c4413137">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],["psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe"],["votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9","votaciones_dia_9"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[0.2831872990355674,0.191915203452041,0.2988063035654555,0.2925490590398822,0.3050849962721756,0.2888203766474756,0.2305710687931895,0.2729814579729568,0.2323851741203501,0.302215318816315,0.2805668689731574,0.2976048719711302,0.2927713604096406,0.2978371952720811,0.3022861854392046,0.2738490670299963,0.2290944530218575,0.2998849652417236,0.260815794324886,0.2484832349520347,0.2983936945950808,0.2938176286616674,0.282985491952344,0.3005456949243082,0.2736056544399583,0.2843643278643804,0.2727317442969254,0.2899465699513651,0.2671677596435927,0.2833007055077989,0.292842763231524,0.2925908599948416,0.2989984780155326,0.2816533842661512,0.2907154938327921,0.2827913481500048,0.2888910115830708,0.2871878596102946,0.285469929353498,0.2888597768283115,0.2891979140879282,0.2826391398127949,0.2363908595283355,0.3010821261589087,0.2890313092078565,0.2891644801021714,0.2749614567996503,0.2979804827269336,0.2759184206168298,0.2868712040692677,0.29439367291148,0.275253045905519,0.2887830783288686,0.2613336093575088,0.2841556602932437,0.3068676200007154,0.3054256608472061,0.2855421496362248,0.2769162431417199,0.2741304104198857,0.2865609984864439,0.2636725018338718,0.3043144151403033,0.3165906791212565,0.2950642529779381,0.2983824778292722,0.3082936770084106,0.2969922261179124,0.2919610296047906,0.285542800791335,0.2882132991817279,0.2471133546519453,0.288059250421933,0.2697597600717543,0.3059179619074399,0.2954183841503599,0.1856970234402977,0.3134783022861688,0.3141693705694945,0.272526313197985,0.2143061335995508,0.2121202946827629,0.2863799153607682,0.3030237663475664,0.2913153629833797,0.2696181215380584,0.2841293702793995,0.3026348938380302,0.2933594191960002,0.2584828482276482,0.2978428123707388,0.2580423352085651,0.2867547491746292,0.125654742307334,0.2921247461326354,0.2793014882015772,0.1567956429469506,0.3050229535552441,0.2463068188613896,0.2749377954146046],["psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe","psoe"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>.category<\/th>\n      <th>empresa<\/th>\n      <th>time<\/th>\n      <th>n<\/th>\n      <th>.row<\/th>\n      <th>.chain<\/th>\n      <th>.iteration<\/th>\n      <th>.draw<\/th>\n      <th>.epred<\/th>\n      <th>partido<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":".category","targets":1},{"name":"empresa","targets":2},{"name":"time","targets":3},{"name":"n","targets":4},{"name":".row","targets":5},{"name":".chain","targets":6},{"name":".iteration","targets":7},{"name":".draw","targets":8},{"name":".epred","targets":9},{"name":"partido","targets":10}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Y ya que tengo las posterioris, puedo obtener resúmenes de la distribución . como calcular un intervalo de credibilidad para cada partido, al 90% por ejemplo</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>estimaciones <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(partido) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">media =</span> <span class="fu">mean</span>(.epred), </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">mediana=</span> <span class="fu">median</span>(.epred), </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">low =</span> <span class="fu">quantile</span>(.epred, <span class="fl">0.05</span>), </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">high=</span> <span class="fu">quantile</span>(.epred, <span class="fl">0.95</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">across</span>(media<span class="sc">:</span>high, \(x){<span class="dv">100</span><span class="sc">*</span> <span class="fu">round</span>(x,<span class="dv">3</span>)})) <span class="co"># sintaxis nueva y rara para funciones anónimas</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 11 × 5</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    partido          media mediana   low  high</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 psoe              28.4    28.9  24.2  30.8</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 pp                32      32.8  25.6  35.5</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 ciudadanos         0.6     0.7   0     1.4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 podemos            3.5     3.6   2.9   4  </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 vox                9.5     9.7   8.1  10.6</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 ar                 4.4     4.4   3.6   5.2</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 junts              2.1     2.1   1.6   2.7</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 europa_solidaria   1.3     1.4   0.2   2.2</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 sumar              5.8     6     4.7   6.6</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 salf               7.4     5.2   0.4  22.2</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 resto              4.8     4.8   3.7   6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Como vemos, yo diría que empate técnico entre psoe y pp.&nbsp;y para algunos partidos como <em>salf</em> mejor no dar ni el dato dado el intervalo de credibilidad tan ancho.</p>
<p>Pintamos</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>estimaciones <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>.epred, <span class="at">fill =</span> partido)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span> ) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.45</span>)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colores) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Agregando encuestas por diversión. Resultado"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Porcentaje estimado"</span>, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Density"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="meta-analisis-europeas_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Un detalle curioso, y si “la nueva encuesta a día 0” la hiciera el cis. Aunque eso si, gracias al modelo bayesiano matizando un poco sus ansias de victoria socialista.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cis <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">empresa =</span> <span class="st">"cis"</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="dv">0</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span> <span class="dv">1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>cis</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 3</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   empresa  time     n</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 cis         0     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>estimaciones_cis <span class="ot">&lt;-</span>  cis <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_epred_draws</span>(model_multinomial, <span class="at">allow_new_levels =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">partido =</span> <span class="fu">as_factor</span>(.category)) <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>.category)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>estimaciones_cis <span class="sc">|&gt;</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(partido) <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">media =</span> <span class="fu">mean</span>(.epred), </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">mediana=</span> <span class="fu">median</span>(.epred), </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">low =</span> <span class="fu">quantile</span>(.epred, <span class="fl">0.05</span>), </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">high=</span> <span class="fu">quantile</span>(.epred, <span class="fl">0.95</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">across</span>(media<span class="sc">:</span>high, \(x){<span class="dv">100</span><span class="sc">*</span> <span class="fu">round</span>(x,<span class="dv">3</span>)}))   </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 11 × 5</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    partido          media mediana   low  high</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    &lt;fct&gt;            &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 psoe              28.5    29.5  21.6  32.2</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 pp                27.2    28.1  20.7  30.9</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 ciudadanos         0.9     0.9   0.6   1.2</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 podemos            3.5     3.6   2.7   4.1</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 vox                9.4     9.7   7    10.8</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 ar                 3.9     4     2.9   4.6</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 junts              1.6     1.7   1.2   2.1</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 europa_solidaria   1.1     1.1   0.7   1.4</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 sumar              5.6     5.8   4.2   6.5</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 salf              13       9.9   2.3  33.6</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11 resto              5       5.1   3.7   6.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>estimaciones_cis <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>.epred, <span class="at">fill =</span> partido)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span> ) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.45</span>)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colores) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Si yo fuera Tezanos"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Porcentaje estimado"</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Density"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="meta-analisis-europeas_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="finalizando" class="level2">
<h2 class="anchored" data-anchor-id="finalizando">Finalizando</h2>
<p>Sea como fuere, esto es sólo por diversión con el objetivo de mostrar un poco como se pueden agregar encuestas de forma bayesiana. Otra forma es hacer simulaciones como hace Kiko Llaneras. A mi me gusta más al modo bayesiano, y creo que debería salir algo parecido. Pues nada más, vayan a votar o no, no es una obligación sino un derecho. Feliz sábado</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/muestrear-no-es-pecado\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="joscani/blogComments" data-repo-id="R_kgDOIXA9wA" data-category="General" data-category-id="DIC_kwDOIXA9wM4CSZhs" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->




</body></html>